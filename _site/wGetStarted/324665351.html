
<!-- Page generated 2018-11-21 14:46:58 -0800 -->
<!-- relative link basehrefs -->

	
	
	
		
			
		
	
		
			
			


<!-- Logic for 'edit this button' -->



<!-- End of logic for 'edit this button' -->


<!DOCTYPE html>
<html lang="en">

<head>
	<base href="/wGetStarted/" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<style id="page_style" type="text/css">
		@charset "UTF-8";
		[ng\:cloak],
		[ng-cloak],
		[data-ng-cloak],
		[x-ng-cloak],
		.ng-cloak,
		.x-ng-cloak,
		.ng-hide:not(.ng-hide-animate) {
			display: none !important;
		}

		ng\:form {
			display: block;
		}
	</style>

	<!--
	<script type="text/javascript">
	  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="4.0.0";
	  analytics.load("IWj9D0UpZHZdZUZX9jl98PcpBFWBnBMy");
	  analytics.page();
	  }}();
	</script>
	-->
	
	<!-- favicon -->
	<link rel="icon" type="image/x-icon" href="/favicons/docs@2x.ico" sizes="129x128">
	<meta name="msapplication-TileImage" content="/favicons/docs@2x.ico">
	<link rel="apple-touch-icon" type="image/x-icon" href="/favicons/docs@2x.ico" sizes="129x128">
	<meta property="og:image" content="/favicons/docs@2x.ico"/>
	<!-- metadata -->
	

    <link rel="stylesheet" href="/css/font-awesome.min.css">
	<link rel="stylesheet" href="/css/bootstrap.min.css">
	<link id="pygments" rel="stylesheet" href="/css/pygments/perldoc.css">
	<link id="pagestyle" rel="stylesheet" href="/css/style.css">

	<!-- Go get "Open Sans" font from Google -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
	
	
	

</head>	

<body id="main_body" class="colums">
	

	<header>
		 <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="/"><img class="logo" src="/images/site-logo.png" alt="Interject Docs" title="Interject Docs"></a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="search-form" id="search-div" >
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="Search the docs" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">Search</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container">
    <div id="tabs">
        <ul class="tabs" id="jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right hidden-xs hidden-sm">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="btn-group" style="visibility: hidden">
  <button type="button" class="btn btn-default dropdown-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    
  </ul>
</div>

    </div>
</div>

        </div>
    </div>
</nav>
	</header>

	

	<!-- nav bar -->
	<div class="wrapper right-open">
		<div class="container-fluid">
			<div class="row">
				<div class="col-body">
					<main class="col-content content">
						<section class="section">
							
								
							<h1>Interject Documentation > L14.1 Dev> Customer Credit Save</h1> 
									 
									
									<span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">Estimated reading time: </span>
  
  
    30 minutes
  
</span>

									
							
							
							<h2 id="overview"><strong>Overview:</strong></h2>

<p>This section will detail a full review of how the INTERJECT save feature works. Using the Customer Credits example, it will show how to design three user input fields into an existing report. The INTERJECT platform will assist in creating a stored procedure that can be used in SQL Server to help facilitate the process.  Other database engines or API methods can be used for the save process as well, but for simplicity you are focusing on SQL Server and a database stored procedure as the data source.  You will be using the Customer Credits report, as you have already become familiar with its <a href="/wAbout/Customer-Aging_128091294.html"> business use case </a> .</p>

<p>The following topics are covered in this walk-through. To view a topic, click on the link below.</p>

<ol>
  <li>
    <h4 id="-setting-up-the-data-portal--">** Setting up the Data Portal  **</h4>
  </li>
  <li>
    <h4 id="-setting-up-the-formula-parameters--">** Setting up the Formula Parameters  **</h4>
  </li>
  <li>
    <h4 id="-setting-up-the-system-parameters--">** Setting up the System Parameters  **</h4>
  </li>
  <li>** Creating the Report  **</li>
  <li>** Creating the Stored Procedure Using the System Menu  **</li>
  <li>** Testing the Report Save Stored Procedure  **</li>
</ol>

<p>##</p>

<h3 id="setting-up-the-data-portals">Setting up the Data Portals:</h3>

<p>This report uses the same database as  <strong>Dev: Customer Aging</strong> and other reports, you do not need to create another data connection. Use the same connection as in previous labs. The  Data Portals for saving data are very similar to their Pull counterparts.</p>

<p><strong>Step 1:</strong> Navigate to the INTERJECT Portal Website at:  <br />
<a href="https://portal.gointerject.com/"> https://portal.gointerject.com/  </a> then select  <strong>Data Portals</strong> in the sidebar menu.</p>

<p><img src="attachments/324665351/363987110.jpg" alt="" /></p>

<p><strong>Step 2:</strong> Click the  <strong>New Data Portal</strong> button.</p>

<p><img src="attachments/324665351/363987115.jpg" alt="" /></p>

<p><strong>Step 3:</strong> In the  <strong>Data Portal Code</strong> field enter  <strong>NorthwindCreditSave_MyName</strong> .</p>

<p><img src="attachments/324665351/363921478.jpg" alt="" /></p>

<p><strong>Step 4:</strong> In the description, you will fill out a short detail saying what this data portal will be used for. In this case, it will say  <strong>Simple Data Save</strong> .</p>

<p><img src="attachments/324665351/364052563.jpg" alt="" /></p>

<p><strong>Step 5:</strong> In the  <strong>Category</strong> field, label the type of data portal connection that this data portal will be. In this case it will be a  <strong>Demo</strong> .</p>

<p><img src="attachments/324665351/363888725.jpg" alt="" /></p>

<p><strong>Step 6:</strong> In the connection drop down menu you will choose the data connection  <strong>NorthwindExampleDB_MyName</strong> that you have already created.</p>

<p><img src="attachments/324665351/363987120.jpg" alt="" /></p>

<p><strong>Step 7:</strong> For the  <strong>Command Type</strong> you will use the stored procedure option, and in  <strong>Stored Procedure / Command</strong> input a name for the stored procedure you will create later. In this case you use  <strong>[demo].[Northwind_Credit_Save_MyName]</strong> .  Then click  <strong>create data portal.</strong></p>

<p><img src="attachments/324665351/364052568.jpg" alt="" /></p>

<p>##</p>

<h3 id="setting-up-formula-parameters">Setting up Formula Parameters:</h3>

<p>For this Data Portal, there are no formula parameters to be used.</p>

<h3 id="setting-up-system-parameters">Setting up System Parameters:</h3>

<p>System Parameters are similar to Formula Parameters, but the names are reserved. To review the System parameters and their purposes, go to the System Parameters section of the <a href="/wPortal/Data-Portals_324665363.html"> Data Portal </a> page</p>

<p>In this example you are going to use  <strong>Interject_ReturnError</strong> and  <strong>Interject_RequestContext</strong> .</p>

<p><strong>Step 1:</strong> To add the first system parameter, click the  <strong>Click here to</strong> <strong>add a System Parameter</strong> button. Then select  <strong>Interject_RequestContext</strong> for the name and click <strong>save</strong> .</p>

<p><img src="attachments/324665351/363954263.jpg" alt="" /></p>

<p><strong>Step 2:</strong> To add a new system parameter, first click the  <strong>Click here to add a System Parameter</strong> button. Then select  <strong>Interject_ReturnError</strong> for the name of our second parameter. Then click <strong>save</strong> .</p>

<p><img src="attachments/324665351/363954268.jpg" alt="" /></p>

<h3 id="creating-the-report">Creating the Report:</h3>

<p><strong>Step 1:</strong> Unfreeze panes.</p>

<p><img src="attachments/324665351/363954273.jpg" alt="" /></p>

<p><strong>Step 2:</strong> First, <strong>insert</strong> a row above <strong>row 7</strong> select cell  <strong>C7</strong> and input  <strong>=ReportSave()</strong> . Then, click the  <strong>fx</strong> button to open the report wizard.</p>

<p><img src="attachments/324665351/363921483.jpg" alt="" /></p>

<p><strong>Step 3:</strong> In the  <strong>DataPortal</strong> section, input the dataportal name of the dataportal you just created. It was recommended that you name it  <strong>NorthwindCreditSave_MyName.</strong></p>

<p><img src="attachments/324665351/363954278.jpg" alt="" /></p>

<p><strong>Step 4:</strong> The RowDefRange is for your ID row. In this case, input  <strong>B23:B24.</strong></p>

<p><img src="attachments/324665351/363921488.jpg" alt="" /></p>

<p><strong>Step 5:</strong> It is best practice to separate the column definitions. To do so, copy rows 1 and 2, then right click row 3 and insert the copied rows. In cell  <strong>A3</strong> change the value to  <strong>Column Definitions - Save.</strong></p>

<p><img src="attachments/324665351/363790403.jpg" alt="" /></p>

<p><strong>Step 6:</strong> Now delete the values in the range  <strong>C4:G4</strong> so that only the save-optional columns that are remaining. In this case, leave only <strong>CustomerID,</strong> <strong>Credit Limit, AccountFreeze,</strong> and  <strong>AccountNotes</strong></p>

<p><img src="attachments/324665351/363823164.jpg" alt="" /></p>

<p><strong>Step 7:</strong> Saves are often two way processes. They push data back to the database but can also pull in feedback responses and new data. To create the results range and retrieve data, to do this, add  <strong>MessageToUser</strong> to cell  <strong>N6.</strong></p>

<p><img src="attachments/324665351/363921493.jpg" alt="" /></p>

<p><strong>Step 8:</strong> Also make sure to put a  <strong>[Clear]</strong> in cell  <strong>N2,</strong> but not in  <strong>N4,</strong> so that the data can be cleared on pulls.</p>

<p><img src="attachments/324665351/363987125.jpg" alt="" /></p>

<p><strong>Step 9:</strong> Now select the  <strong>ReportSave()</strong> function again and select  <strong>fx.</strong></p>

<p><img src="attachments/324665351/363790408.jpg" alt="" /></p>

<p><strong>Step 10:</strong> In the  <strong>ColDef,</strong> input  <strong>4:4</strong> and  <strong>6:6</strong> in the  <strong>ResultsRange</strong> . The save will not use parameters, so leave it blank.</p>

<p><img src="attachments/324665351/363987130.jpg" alt="" /></p>

<h3 id="creating-the-stored-procedure">Creating the Stored Procedure</h3>

<p><strong>Step 1:</strong> F  irst, select the  <strong>Pull</strong> button and pull the data into the spreadsheet.</p>

<p><strong>Step 2:</strong> In the excel sheet, click the cell with the ReportSave formula. Then  click  <strong>Advanced Menu</strong> in the INTERJECT Ribbon. This button is a toggle, so if it is currently showing  <strong>Simple Menu</strong> do not click it.</p>

<p><strong>Step 3:</strong> Then, click the  <strong>System</strong> dropdown and select  <strong>View SQL Template for ActiveCell</strong> . Make sure you have the ReportSave cell selected.</p>

<p>A window will pop up providing the developer with the SQL template used to create the stored procedure.</p>

<p>Copy and paste the template code into the MSSQL Server from your Excel sheet. This template is a helpful starting point that includes the Data Portal parameters and pre-formatted test code, but more work is needed to construct the required data save. Here is an example test code to compare with, but yours will be different. Do not copy this code and use it for your report as it will not work.</p>

<p><strong>Template Procedure</strong> Expand source</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CREATE PROC [demo].[Northwind_Credit_Save_MyName]

	-- System Params not in formula
	@Interject_RequestContext nvarchar(max)
	,@Interject_ReturnError varchar(2000) OUTPUT
	,@TestMode bit = 0 -- used only for testing the stored procedure directly.  It will show more results when set to 1.


AS

/*
==================================================================================
	CREATED DATE:
	CREATED BY: Interject Default
	DESCRIPTION: Example data pull to be used with Interject
	
	---------------------------------------------------------------------------
	TEST Example: Use the below to test this stored procedure:
	---------------------------------------------------------------------------
	
	DECLARE @Interject_ReturnError varchar(2000)

	EXEC [demo].[Northwind_Credit_Save_MyName]
		@TestMode = 1
		,@Interject_RequestContext = '&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;
&lt;RequestContext&gt;
    &lt;ExcelVersion&gt;&lt;/ExcelVersion&gt;
    &lt;IdsVersion&gt;&lt;/IdsVersion&gt;
    &lt;FileName&gt;&lt;/FileName&gt;
    &lt;FilePath&gt;&lt;/FilePath&gt;
    &lt;TabName&gt;&lt;/TabName&gt;
    &lt;CellRange&gt;C11&lt;/CellRange&gt;
    &lt;SourceFunction&gt;Save&lt;/SourceFunction&gt;
    &lt;UtcOffset&gt;-7&lt;/UtcOffset&gt;
    &lt;ColDefItems&gt;
        &lt;Value Row="4" Column="2"&gt;
            &lt;Name&gt;CustomerID&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="4" Column="8"&gt;
            &lt;Name&gt;CreditLimit&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="4" Column="11"&gt;
            &lt;Name&gt;AccountFreeze&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="4" Column="13"&gt;
            &lt;Name&gt;AccountNotes&lt;/Name&gt;
        &lt;/Value&gt;
    &lt;/ColDefItems&gt;
    &lt;ResultDefItems&gt;
        &lt;Value Row="6" Column="14"&gt;
            &lt;Name&gt;[MessageToUser]&lt;/Name&gt;
        &lt;/Value&gt;
    &lt;/ResultDefItems&gt;
    &lt;RowDefItems&gt;
        &lt;Value Row="27" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;ALFKI&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="28" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;ANATR&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="29" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;ANTON&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="30" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;AROUT&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="31" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;BERGS&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="32" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;BLONP&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="33" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;BONAP&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="34" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;BOTTM&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="35" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;BSBEV&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="36" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;CACTU&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="37" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;CENTC&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="38" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;CHOPS&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="39" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;WANDK&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="40" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;DRACD&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="41" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;DUMON&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="42" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;EASTC&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="43" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;ERNSH&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="44" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;FAMIA&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="45" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;FOLIG&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="46" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;FOLKO&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="47" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;FRANR&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="48" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;FRANS&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="49" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;FRANK&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="50" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;FURIB&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="51" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;GALED&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="52" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;GODOS&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="53" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;GOURL&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="54" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;GREAL&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="55" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;HANAR&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="56" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;HILAA&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="57" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;HUNGC&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="58" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;HUNGO&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="59" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;ISLAT&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="60" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;KOENE&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="61" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;LACOR&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="62" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;LAMAI&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="63" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;LAUGB&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="64" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;LEHMS&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="65" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;LETSS&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="66" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;LILAS&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="67" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;LINOD&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="68" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;LONEP&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="69" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;MAGAA&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="70" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;MEREP&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="71" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;MORGK&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="72" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;OCEAN&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="73" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;OLDWO&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="74" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;OTTIK&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="75" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;PERIC&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="76" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;PICCO&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="77" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;PRINI&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="78" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;QUEDE&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="79" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;QUEEN&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="80" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;QUICK&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="81" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;RANCH&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="82" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;RATTC&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="83" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;REGGC&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="84" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;RICAR&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="85" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;RICSU&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="86" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;SANTG&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="87" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;SAVEA&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="88" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;SEVES&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="89" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;SPECD&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="90" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;SPLIR&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="91" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;SUPRD&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="92" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;THECR&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="93" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;TOMSP&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="94" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;TORTU&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="95" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;TRADH&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="96" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;VAFFE&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="97" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;VICTE&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="98" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;VINET&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="99" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;WARTH&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="100" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;WELLI&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="101" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;WHITC&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="102" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;WILMK&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="103" Column="2" ColumnName="CustomerID"&gt;
            &lt;Name&gt;WOLZA&lt;/Name&gt;
        &lt;/Value&gt;
    &lt;/RowDefItems&gt;
    &lt;UserContext&gt;
    &lt;MachineLoginName&gt;&lt;/MachineLoginName&gt;
    &lt;MachineName&gt;.&lt;/MachineName&gt;
    &lt;FullName&gt; &lt;/FullName&gt;
    &lt;UserId&gt;UFR62JQWx4&lt;/UserId&gt;
    &lt;ClientId&gt;CgCfW9qi&lt;/ClientId&gt;
    &lt;LoginName&gt;&lt;/LoginName&gt;
    &lt;LoginAuthTypeId&gt;10&lt;/LoginAuthTypeId&gt;
    &lt;LoginDateUtc&gt;&lt;/LoginDateUtc&gt;
    &lt;UserRoles&gt;
        &lt;Role&gt;&lt;/Role&gt;
    &lt;/UserRoles&gt;
&lt;/UserContext&gt;
    &lt;UserContextEncrypted&gt;Encrypted only through interject api protocol, not direct connection&lt;/UserContextEncrypted&gt;
    &lt;XMLDataToSave&gt;
  &lt;c Column="Row" OrigValue="Row" /&gt;
  &lt;c Column="CustomerID" OrigValue="CustomerID" /&gt;
  &lt;c Column="CreditLimit" OrigValue="CreditLimit" /&gt;
  &lt;c Column="AccountFreeze" OrigValue="AccountFreeze" /&gt;
  &lt;c Column="AccountNotes" OrigValue="AccountNotes" /&gt;
  &lt;r&gt;
    &lt;Row&gt;27&lt;/Row&gt;
    &lt;CustomerID&gt;ALFKI&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;28&lt;/Row&gt;
    &lt;CustomerID&gt;ANATR&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;29&lt;/Row&gt;
    &lt;CustomerID&gt;ANTON&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;30&lt;/Row&gt;
    &lt;CustomerID&gt;AROUT&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;31&lt;/Row&gt;
    &lt;CustomerID&gt;BERGS&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;32&lt;/Row&gt;
    &lt;CustomerID&gt;BLONP&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;33&lt;/Row&gt;
    &lt;CustomerID&gt;BONAP&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;34&lt;/Row&gt;
    &lt;CustomerID&gt;BOTTM&lt;/CustomerID&gt;
    &lt;CreditLimit&gt;50000&lt;/CreditLimit&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;35&lt;/Row&gt;
    &lt;CustomerID&gt;BSBEV&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;36&lt;/Row&gt;
    &lt;CustomerID&gt;CACTU&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;37&lt;/Row&gt;
    &lt;CustomerID&gt;CENTC&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;38&lt;/Row&gt;
    &lt;CustomerID&gt;CHOPS&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;39&lt;/Row&gt;
    &lt;CustomerID&gt;WANDK&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;40&lt;/Row&gt;
    &lt;CustomerID&gt;DRACD&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;41&lt;/Row&gt;
    &lt;CustomerID&gt;DUMON&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;42&lt;/Row&gt;
    &lt;CustomerID&gt;EASTC&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;43&lt;/Row&gt;
    &lt;CustomerID&gt;ERNSH&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;44&lt;/Row&gt;
    &lt;CustomerID&gt;FAMIA&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;45&lt;/Row&gt;
    &lt;CustomerID&gt;FOLIG&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;46&lt;/Row&gt;
    &lt;CustomerID&gt;FOLKO&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;47&lt;/Row&gt;
    &lt;CustomerID&gt;FRANR&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;48&lt;/Row&gt;
    &lt;CustomerID&gt;FRANS&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;49&lt;/Row&gt;
    &lt;CustomerID&gt;FRANK&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;50&lt;/Row&gt;
    &lt;CustomerID&gt;FURIB&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;51&lt;/Row&gt;
    &lt;CustomerID&gt;GALED&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;52&lt;/Row&gt;
    &lt;CustomerID&gt;GODOS&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;53&lt;/Row&gt;
    &lt;CustomerID&gt;GOURL&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;54&lt;/Row&gt;
    &lt;CustomerID&gt;GREAL&lt;/CustomerID&gt;
    &lt;CreditLimit&gt;50000&lt;/CreditLimit&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;55&lt;/Row&gt;
    &lt;CustomerID&gt;HANAR&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;56&lt;/Row&gt;
    &lt;CustomerID&gt;HILAA&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;57&lt;/Row&gt;
    &lt;CustomerID&gt;HUNGC&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;58&lt;/Row&gt;
    &lt;CustomerID&gt;HUNGO&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;59&lt;/Row&gt;
    &lt;CustomerID&gt;ISLAT&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;60&lt;/Row&gt;
    &lt;CustomerID&gt;KOENE&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;61&lt;/Row&gt;
    &lt;CustomerID&gt;LACOR&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;62&lt;/Row&gt;
    &lt;CustomerID&gt;LAMAI&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;63&lt;/Row&gt;
    &lt;CustomerID&gt;LAUGB&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;64&lt;/Row&gt;
    &lt;CustomerID&gt;LEHMS&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;65&lt;/Row&gt;
    &lt;CustomerID&gt;LETSS&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;66&lt;/Row&gt;
    &lt;CustomerID&gt;LILAS&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;67&lt;/Row&gt;
    &lt;CustomerID&gt;LINOD&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;68&lt;/Row&gt;
    &lt;CustomerID&gt;LONEP&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;69&lt;/Row&gt;
    &lt;CustomerID&gt;MAGAA&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;70&lt;/Row&gt;
    &lt;CustomerID&gt;MEREP&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;71&lt;/Row&gt;
    &lt;CustomerID&gt;MORGK&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;72&lt;/Row&gt;
    &lt;CustomerID&gt;OCEAN&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;73&lt;/Row&gt;
    &lt;CustomerID&gt;OLDWO&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;74&lt;/Row&gt;
    &lt;CustomerID&gt;OTTIK&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;75&lt;/Row&gt;
    &lt;CustomerID&gt;PERIC&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;76&lt;/Row&gt;
    &lt;CustomerID&gt;PICCO&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;77&lt;/Row&gt;
    &lt;CustomerID&gt;PRINI&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;78&lt;/Row&gt;
    &lt;CustomerID&gt;QUEDE&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;79&lt;/Row&gt;
    &lt;CustomerID&gt;QUEEN&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;80&lt;/Row&gt;
    &lt;CustomerID&gt;QUICK&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;81&lt;/Row&gt;
    &lt;CustomerID&gt;RANCH&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;82&lt;/Row&gt;
    &lt;CustomerID&gt;RATTC&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;83&lt;/Row&gt;
    &lt;CustomerID&gt;REGGC&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;84&lt;/Row&gt;
    &lt;CustomerID&gt;RICAR&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;85&lt;/Row&gt;
    &lt;CustomerID&gt;RICSU&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;86&lt;/Row&gt;
    &lt;CustomerID&gt;SANTG&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;87&lt;/Row&gt;
    &lt;CustomerID&gt;SAVEA&lt;/CustomerID&gt;
    &lt;CreditLimit&gt;90000&lt;/CreditLimit&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;88&lt;/Row&gt;
    &lt;CustomerID&gt;SEVES&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;89&lt;/Row&gt;
    &lt;CustomerID&gt;SPECD&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;90&lt;/Row&gt;
    &lt;CustomerID&gt;SPLIR&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;91&lt;/Row&gt;
    &lt;CustomerID&gt;SUPRD&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;92&lt;/Row&gt;
    &lt;CustomerID&gt;THECR&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;93&lt;/Row&gt;
    &lt;CustomerID&gt;TOMSP&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;94&lt;/Row&gt;
    &lt;CustomerID&gt;TORTU&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;95&lt;/Row&gt;
    &lt;CustomerID&gt;TRADH&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;96&lt;/Row&gt;
    &lt;CustomerID&gt;VAFFE&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;97&lt;/Row&gt;
    &lt;CustomerID&gt;VICTE&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;98&lt;/Row&gt;
    &lt;CustomerID&gt;VINET&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;99&lt;/Row&gt;
    &lt;CustomerID&gt;WARTH&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;100&lt;/Row&gt;
    &lt;CustomerID&gt;WELLI&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;101&lt;/Row&gt;
    &lt;CustomerID&gt;WHITC&lt;/CustomerID&gt;
    &lt;CreditLimit&gt;50000&lt;/CreditLimit&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;102&lt;/Row&gt;
    &lt;CustomerID&gt;WILMK&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
  &lt;r&gt;
    &lt;Row&gt;103&lt;/Row&gt;
    &lt;CustomerID&gt;WOLZA&lt;/CustomerID&gt;
    &lt;CreditLimit /&gt;
    &lt;AccountFreeze /&gt;
    &lt;AccountNotes /&gt;
  &lt;/r&gt;
    &lt;/XMLDataToSave&gt;
&lt;/RequestContext&gt;'
		,@Interject_ReturnError = @Interject_ReturnError OUTPUT

	SELECT 	@Interject_ReturnError as '@Interject_ReturnError'


	---------------------------------------------------------------------------
	Validation Example:
	---------------------------------------------------------------------------
	Note: By adding 'UserNotice:' to the error message, Interject will show the message in an alert box and not flag the formula with an error.
	Without it, the formula will show an error with the text the user can click into.
	
	IF @ParameterName = 'TheWrongValue'
	BEGIN
		RAISERROR ('UserNotice:You selected an invalid value. Unable to continue.',
		18, -- Severity,
		1) -- State)
		
		RETURN
	END
	
	---------------------------------------------------------------------------
	Reserved Parameters:
	---------------------------------------------------------------------------
	Note: If the below parameters are added to your stored procedure and to the
	dataportal parameter list, Interject will pass the related value automatically.
	
	@Interject_XMLDataToSave varchar(max) - Required for saving data. It contains XML for the designated cells values.
	@Interject_ColDefItems  varchar(max) - Provides the Column Definitions in XML designated within the report formula.
	@Interject_RowDefItems varchar(max) - Provides the Row Definitions in XML designated within the report formula.
	@Interject_SourceFileAndPath varchar(500) - Provides the path and file name delimited by '|' of the current file.
	@Interject_SourceFilePathAndTab varchar(1000) - Provides the path, file name and active tab name delimited by '|' of the current file.
	@Interject_LocalTimeZoneOffset money - Provides a number (0.000) that represents the offset of the users time to UTC time.
	@Interject_NTLogin varchar(50) - Provides the user's computer login name for their current session.
	@Interject_UserID varchar(50) - Provides the Interject User ID for their current session.
	@Interject_LoginName varchar(50) - Provides the Interject Full name for their current session.
	@Interject_ExcelVersion varchar(50) - Provides the users Excel version.
	@Interject_UserRoles varchar(1000) - Provides the Interject roles assigned to the user.
	@Interject_ClientID varchar(50) - Provides the Interject Client ID for their current session.
	@Interject_ReturnError varchar(2000) - Is an output parameter that can be used to return an error back to the user. Pass empty string for no error.
	@Interject_RequestContext nvarchar(max) - Provides all above request context and both the open text and encrypted version of the user context.

==================================================================================
*/

	--
	-- Use helper to extract data from Interject_RequestContext. Remove items that are not needed
	-- The helper stored procedure [dbo].[RequestContext_Parse] is required for this section to function 
	--
	
	DECLARE
		@ExcelVersion					NVARCHAR(100)
		,@IdsVersion					NVARCHAR(100)	
		,@FileName						NVARCHAR(1000)	
		,@FilePath						NVARCHAR(1000)
		,@TabName						NVARCHAR(1000)	
		,@CellRange						NVARCHAR(100)	
		,@SourceFunction				NVARCHAR(100)	
		,@UtcOffset						DECIMAL(6,4)	
		,@ColDefItemsDelimited			xml	
		,@ResultDefItemsDelimited		xml	
		,@RowDefItemsDelimited			xml
		,@MachineLoginName				NVARCHAR(100)
		,@MachineName					NVARCHAR(100)	
		,@Interject_UserID				NVARCHAR(100)
		,@Interject_ClientID			NVARCHAR(100)
		,@Interject_LoginName			NVARCHAR(100)	
		,@Interject_LoginAuthTypeID		INT		
		,@Interject_LoginDateUTC		DATETIME
		,@Interject_UserRolesDelimited	NVARCHAR(max)
		,@UserContextEncrypted			NVARCHAR(4000)
		,@Interject_XMLDataToSave	    xml	
	
	EXEC [dbo].[RequestContext_Parse]
		@Interject_RequestContext		= @Interject_RequestContext
		,@ExcelVersion					 = @ExcelVersion			 OUTPUT
		,@IdsVersion					 = @IdsVersion				 OUTPUT
		,@FileName						 = @FileName				 OUTPUT
		,@FilePath						 = @FilePath				 OUTPUT
		,@TabName						 = @TabName					 OUTPUT
		,@CellRange						 = @CellRange				 OUTPUT
		,@SourceFunction				 = @SourceFunction			 OUTPUT
		,@UtcOffset						 = @UtcOffset				 OUTPUT
		,@ColDefItemsDelimited			 = @ColDefItemsDelimited	 OUTPUT
		,@ResultDefItemsDelimited		 = @ResultDefItemsDelimited	 OUTPUT
		,@RowDefItemsDelimited			 = @RowDefItemsDelimited	 OUTPUT
		,@MachineLoginName				 = @MachineLoginName		 OUTPUT
		,@MachineName					 = @MachineName				 OUTPUT
		,@Interject_UserID				 = @Interject_UserID		 OUTPUT
		,@Interject_ClientID			 = @Interject_ClientID		 OUTPUT
		,@Interject_LoginName			 = @Interject_LoginName		 OUTPUT
		,@Interject_LoginAuthTypeID		 = @Interject_LoginAuthTypeID OUTPUT
		,@Interject_LoginDateUTC		 = @Interject_LoginDateUTC	 OUTPUT
		,@Interject_UserRolesDelimited	 = @Interject_UserRolesDelimited	OUTPUT
		,@UserContextEncrypted			 = @UserContextEncrypted	 OUTPUT
		,@Interject_XMLDataToSave		 = @Interject_XMLDataToSave	 OUTPUT
	
	IF @TestMode = 1
	BEGIN
		SELECT
			@ExcelVersion					as '@ExcelVersion'
			,@IdsVersion					as '@IdsVersion'
			,@FileName						as '@FileName'
			,@FilePath						as '@FilePath '
			,@TabName						as '@TabName'
			,@CellRange						as '@CellRange'
			,@SourceFunction				as '@SourceFunction'
			,@UtcOffset						as '@UtcOffset'
			,@ColDefItemsDelimited			as '@ColDefItemsDelimited'
			,@ResultDefItemsDelimited		as '@ResultDefItemsDelimited'
			,@RowDefItemsDelimited			as '@RowDefItemsDelimited'
			,@MachineLoginName				as '@MachineLoginName'
			,@MachineName					as '@MachineName'
			,@Interject_UserID				as '@Interject_UserID'
			,@Interject_ClientID			as '@Interject_ClientID'
			,@Interject_LoginName			as '@Interject_LoginName'
			,@Interject_LoginAuthTypeID		as '@Interject_LoginAuthTypeID'
			,@Interject_LoginDateUTC		as '@Interject_LoginDateUTC'
			,@Interject_UserRolesDelimited	as '@Interject_UserRolesDelimited'
			,@UserContextEncrypted			as '@UserContextEncrypted'
			,@Interject_XMLDataToSave		as '@Interject_XMLDataToSave'
	END


	
	DECLARE @ErrorMessageToUser as varchar(1000) = ''
	
	--
	-- PROCESS THE XML DATA INTO TABLE VARIABLE
	-- varchar(max) is used for the data type by default.  Please change for the specific requirement.
	--
	
	DECLARE @DataToProcess TABLE
	(
		-- the below are system values used internally in this stored procedures
		 [_ExcelRow] INT 
		,[_MessageToUser] VARCHAR(500) DEFAULT('')
		-- Below are your columns expected from the spreadsheet that is calling this save stored procedure
		-- Please change the (max) to the expected length of the text input.  If limiting length, be sure to make the size larger than allowed so you can add validation to notify the user
	
		,[CustomerID] VARCHAR(max)
		,[CreditLimit] VARCHAR(max)
		,[AccountFreeze] VARCHAR(max)
		,[AccountNotes] VARCHAR(max)
		-- remove the following columns after updating this code for your real data.  These are used for validation illustrations only
		,[ExampleColumnKey] INT
		,[ExampleColumnValue] VARCHAR(100)
	)
	
	IF DATALENGTH(@Interject_XMLDataToSave) &gt; 0 
	BEGIN
		declare @DataToProcessXML as XML
		-- Handle conversion of XML text into an XML variable.  
		BEGIN TRY
			SET @DataToProcessXML = CAST(@Interject_XMLDataToSave as XML)
		END TRY
		BEGIN CATCH
			SET @ErrorMessageToUser = 'Error in Parsing XML from Interject.  Error: ' + ERROR_MESSAGE()
			GOTO FinalResponseToUser
		END CATCH
		
		-- Insert the XML into the table variable for further processing
		INSERT into @DataToProcess(
			[_ExcelRow]
			-- The below columns are provided based on your column definitions in the ReportSave() function]
			,[CustomerID]
			,[CreditLimit]
			,[AccountFreeze]
			,[AccountNotes]

			-- The below columns are provided to help with this example.  Please remove.
			,[ExampleColumnKey]
			,[ExampleColumnValue]
		)
		SELECT
			-- The below row value is always provided by Interject
			T.c.value('./Row[1]', 'INT') as [_ExcelRow]
			-- The below columns are provided based on your column definitions in the ReportSave() function
			,T.c.value('./CustomerID[1]', 'VARCHAR(max)') as [CustomerID]
			,T.c.value('./CreditLimit[1]', 'VARCHAR(max)') as [CreditLimit]
			,T.c.value('./AccountFreeze[1]', 'VARCHAR(max)') as [AccountFreeze]
			,T.c.value('./AccountNotes[1]', 'VARCHAR(max)') as [AccountNotes]

			-- The below columns are provided to help with this example.  Please remove.
			,T.c.value('./ExampleyColumnKey[1]', 'VARCHAR(100)') as [ExampleColumnKey]
			,T.c.value('./ExampleColumnValue[1]', 'INT') as [ExampleColumnValue]
		FROM @DataToProcessXML.nodes('/XMLDataToSave/r') T(c)
	END
	
	-- TestMode is provided so a test save can be executed and all related data can be 
	-- easily viewed for testing while not effecting any data in the database
	IF @TestMode =1 
	BEGIN
		SELECT '@DataToProcess - After XML Processing' as ResultName
		SELECT * FROM @DataToProcess
	END
	
	--
	-- VALIDATION SECTION - Ensure inputs received from Excel are valid
	--
	
	-- Validate a stored procedure parameter input passed from the spreadsheet.  
	DECLARE @ParameterExample as varchar(50)  -- This is declared only to simulate a store procedure parameter
	IF @ParameterExample = 'TheWrongValue' and 'SkipThisExample' = 'True'
	BEGIN
		SET @ErrorMessageToUser = 'You selected an invalid value for ''Example Input''. Save aborted.'
		GOTO FinalResponseToUser
	END
	
	-- Validate that the details do not have duplicates on the primary key
	UPDATE m
	SET [_MessageToUser] = [_MessageToUser] + ', Duplicate key'
	FROM @DataToProcess m
	INNER JOIN
		(
			SELECT [ExampleColumnKey] 
			FROM @DataToProcess
			WHERE [ExampleColumnKey] &lt;&gt; ''
			GROUP BY [ExampleColumnKey]
			HAVING COUNT(1) &gt; 1
		) as t
		ON
			m.ExampleColumnKey = t.ExampleColumnKey
	
	-- Validate a column in a detail row, but don't exit if error since we can check multiple issues before notifing the user
	UPDATE @DataToProcess
	SET [_MessageToUser] = [_MessageToUser] + ', [ExampleColumnValue] is a required entry'
	WHERE [ExampleColumnValue] = ''
	
	-- Validate a column has valid text
	UPDATE @DataToProcess
	SET [_MessageToUser] = [_MessageToUser] + ', [ExampleColumnValue] must be either Yes or No'
	WHERE [ExampleColumnValue] IN ('Yes','No')
	
	-- Now check if there were any validation issues in the detail and stop processing if true
	IF EXISTS(SELECT 1 FROM @DataToProcess WHERE [_MessageToUser] &lt;&gt; '')
	BEGIN
		SET @ErrorMessageToUser = 'There were errors in the details of your input.  Please review the errors noted in each row.'
		GOTO FinalResponseToUser
	END
	
	IF @TestMode =1 
	BEGIN
		SELECT '@DataToProcess - After Validation' as ResultName
		SELECT * FROM @DataToProcess
	END
	
	--
	-- DATA UPDATE
	--
	
	-- This represents the table where the data would be updated to.  Remove this temp table since it is for example purposes only.
	CREATE TABLE #ExampleTableToUpdate 
	(
		[ExampleColumnKey]		INT PRIMARY KEY
		,[ExampleColumnValue]	VARCHAR(100)

		,[CustomerID] VARCHAR(max)
		,[CreditLimit] VARCHAR(max)
		,[AccountFreeze] VARCHAR(max)
		,[AccountNotes] VARCHAR(max)
	)
	BEGIN TRY
		
		-- this table variable will log the changes to the target table so it can be used
		-- to return helpful feedback to the user about how the save action resulted
		DECLARE @ChangeLog as TABLE
		(
			[_ExcelRow] INT	-- will capture the source row that affected the target table
			,[UpdateTypeCode] VARCHAR(10)  -- Will show UPDATE, INSERT, or DELETE
			,[TargetTableKey] INT
		)
		
		BEGIN TRAN t1
			--
			--  use MERGE statement that UPDATES, INSERTS, and DELETES in one action
			--
			MERGE #ExampleTableToUpdate t -- t = the target table or view to update
			USING (
				SELECT
				* -- specify your specific columns to be used
				FROM @DataToProcess 
			) s -- s = the source data to be used to update the target table
			-- the join on the column keys is specified below
			ON 
				s.[ExampleColumnKey] = t.[ExampleColumnKey]
				
			WHEN MATCHED -- Handles the update based on INNER JOIN
				AND NOT 
				(
					t.[ExampleColumnValue] = t.[ExampleColumnValue] -- To ensure only changes are captured
				)
				THEN
				UPDATE SET
					t.[ExampleColumnValue] = s.[ExampleColumnValue]
			--WHEN NOT MATCHED BY TARGET THEN -- Handles the insert based on LEFT JOIN -- NOT USED IN THIS SIMPLE EXAMPLE
			-- INSERT([ExampleColumnKey],[ExampleColumnValue])
			-- VALUES(s.ExampleColumnKey],s.[ExampleColumnValue])
			
			--WHEN NOT MATCHED BY SOURCE -- Handles the delete based on the RIGHT JOIN -- NOT USED IN THIS SIMPLE EXAMPLE
			-- AND... add restrictions so delete doesn't remove too much. Filter params are normally considered here.
			-- THEN 
			-- DELETE
				
			-- the output captures the changes to the table and logs to a table variable
			OUTPUT 
				isnull(inserted.[ExampleColumnKey],deleted.[ExampleColumnKey])  -- include deleted in case delete is added later. Inserted is used for both Update an Insert
				,s.[_ExcelRow] 
				,$action as UpdateTypeCode  -- this logs into an a change log table variable
			INTO @ChangeLog
			(
				[TargetTableKey]
				,[_ExcelRow]
				,[UpdateTypeCode]
			); 
			
			--now we have enough information to update the message to user for each row
			UPDATE dtp
			SET [_MessageToUser] = 
				CASE cl.UpdateTypeCode
					--WHEN 'INSERT' THEN ', Added!'  -- not used in this example
					--WHEN 'DELETE' THEN ', Deleted' -- this will never match the excel side but can be used for other types of logging
					WHEN 'UPDATE' THEN ', Updated!'
					--ELSE ', No change'  -- not used in this example
				END 
			FROM @DataToProcess dtp
				INNER JOIN @ChangeLog cl  -- use Left Join if 'No Change' is to be identified
					 ON dtp.[_ExcelRow] = cl.[_ExcelRow]
				
		IF @TestMode = 1
		BEGIN
			SELECT '@ChangeLog- Show log of changes made' as ResultName
			select * from @ChangeLog
			
			ROLLBACK TRAN t1 -- note this does not roll back changes to table variables, only real tables
			SELECT 'Changes rolled back since in TEST mode!' as TestModeNote
		END
		ELSE
		BEGIN
			COMMIT TRAN t1
		END
	END TRY
	BEGIN CATCH
		IF @@TRANCOUNT &gt; 0
			ROLLBACK TRAN t1
		
		SET @ErrorMessageToUser =  ERROR_MESSAGE()
		GOTO FinalResponseToUser
	END CATCH
	
FinalResponseToUser:
--
-- PROVIDE RESPONSE TO THE SAVE ACTION
--
	
	-- if test mode, show the final table 
	IF @TestMode = 1 
	BEGIN
		SELECT '@DataToProcess - After Validation' as ResultName
		SELECT * FROM @DataToProcess
	END
	
	-- return the recordset results back to the spreadsheet, if needed.
	SELECT
		[_ExcelRow] as [Row] -- this relates to the original row of the spreadsheet the data came from
		,SUBSTRING([_MessageToUser],3,1000) as [MessageToUser]  -- This is a field that, if it matches a column in the Results Range, will be placed in that column for the specified row
	FROM @DataToProcess
	
	-- if there is an error, raise error and Interject will catch and present to the user.
	-- Note that this is specifically done after the above resultset is returned, since initiating an error before
	-- will not allow a result set to be returned to provide feedback on each row 
	IF @ErrorMessageToUser &lt;&gt; ''
	BEGIN
		-- by adding 'UserNotice:' as a prefix to the message, Interject will not consider it a unhandled error 
		-- and will present the error to the user in a message box.
		SET @ErrorMessageToUser = 'UserNotice:' + @ErrorMessageToUser
		
		RAISERROR (@ErrorMessageToUser,
		18, -- Severity,
		1) -- State)
		RETURN
	END
</code></pre></div></div>

<p>After getting the template, it is important to modify the procedure for what is needed. For example, the parameters are automatically set to max, so an easy change would be to set them to more realistic character lengths.</p>

<p><strong>Altered Procedure</strong> Expand source</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ALTER PROC [demo].[Northwind_Credit_Save_MyName]

	@Interject_RequestContext nvarchar(max)
	,@Interject_ReturnError varchar(2000) OUTPUT
	,@TestMode bit = 0

AS

	--
	-- Use helper to extract data from Interject_RequestContext. Remove items that are not needed
	-- The helper stored procedure [dbo].[RequestContext_Parse] is required for this section to function 
	--
	DECLARE @Interject_XMLDataToSave	    XML	
	DECLARE @Interject_NTLogin				VARCHAR(50)

	EXEC [dbo].[RequestContext_Parse]
		 @Interject_RequestContext		= @Interject_RequestContext
		,@Interject_XMLDataToSave		= @Interject_XMLDataToSave	OUTPUT
		,@MachineLoginName				= @Interject_NTLogin		OUTPUT
	
	IF @TestMode = 1
	BEGIN
		SELECT
			 @Interject_XMLDataToSave	AS '@Interject_XMLDataToSave'
			,@Interject_NTLogin			AS '@Interject_NTLogin'
	END
	
	DECLARE @ErrorMessageToUser AS VARCHAR(1000) = ''
	DECLARE @NowUTC				AS DATETIME = GETUTCDATE()
	--
	-- PROCESS THE XML DATA INTO TABLE VARIABLE
	--
	
	DECLARE @DataToProcess TABLE
	(
		 [_ExcelRow] INT 
		,[_MessageToUser] VARCHAR(500) DEFAULT('')
		,[CustomerID] VARCHAR(max)
		,[CreditLimit] VARCHAR(max)
		,[AccountFreeze] VARCHAR(max)
		,[_FreezeBit] BIT DEFAULT(0)
		,[AccountNotes] VARCHAR(max)
	)
	
	IF DATALENGTH(@Interject_XMLDataToSave) &gt; 0 
	BEGIN
		declare @DataToProcessXML as XML
		-- Handle conversion of XML text into an XML variable.  
		BEGIN TRY
			SET @DataToProcessXML = CAST(@Interject_XMLDataToSave as XML)
		END TRY
		BEGIN CATCH
			SET @ErrorMessageToUser = 'Error in Parsing XML from Interject.  Error: ' + ERROR_MESSAGE()
			GOTO FinalResponseToUser
		END CATCH
		
		-- Insert the XML into the table variable for further processing
		INSERT into @DataToProcess(
			 [_ExcelRow]
			,[CustomerID]
			,[CreditLimit]
			,[AccountFreeze]
			,[AccountNotes]
		)
		SELECT
			
			 T.c.value('./Row[1]', 'INT') as [_ExcelRow]
			,T.c.value('./CustomerID[1]', 'VARCHAR(max)') as [CustomerID]
			,T.c.value('./CreditLimit[1]', 'VARCHAR(max)')	 as [CreditLimit]
			,T.c.value('./AccountFreeze[1]', 'VARCHAR(max)') as [AccountFreeze]
			,T.c.value('./AccountNotes[1]', 'VARCHAR(max)')	 as [AccountNotes]
		FROM @DataToProcessXML.nodes('/XMLDataToSave/r') T(c)
	END
	
	-- TestMode is provided so a test save can be executed and all related data can be 
	-- easily viewed for testing while not effecting any data in the database
	IF @TestMode =1 
	BEGIN
		SELECT '@DataToProcess - After XML Processing' as ResultName
		SELECT * FROM @DataToProcess
	END
	
	--
	-- VALIDATION SECTION - Ensure inputs received from Excel are valid
	--
	
	-- Validate that the details do not have duplicates on the primary key
	UPDATE m
	SET [_MessageToUser] = [_MessageToUser] + ', Duplicate key'
	FROM @DataToProcess m
	INNER JOIN
		(
			SELECT [CustomerID] 
			FROM @DataToProcess
			WHERE [CustomerID] &lt;&gt; ''
			GROUP BY [CustomerID]
			HAVING COUNT(1) &gt; 1
		) as t
		ON
			m.[CustomerID] = t.[CustomerID]
	
	-- Validate a column has valid text
	UPDATE @DataToProcess
	SET [_MessageToUser] = [_MessageToUser] + ', Account Freeze must be either Yes or left blank'
	WHERE [AccountFreeze] NOT IN ('Yes','')

	UPDATE @DataToProcess
		SET [_MessageToUser] = [_MessageToUser] + ', Account Notes must be 140 characters or less'
	FROM @DataToProcess 
	WHERE LEN([AccountNotes]) &gt;= 140
	
	-- Now check if there were any validation issues in the detail and stop processing if true
	IF EXISTS(SELECT 1 FROM @DataToProcess WHERE [_MessageToUser] &lt;&gt; '')
	BEGIN
		SET @ErrorMessageToUser = 'There were errors in the details of your input.  Please review the errors noted in each row.'
		GOTO FinalResponseToUser
	END
	
	
	IF @TestMode = 1 
	BEGIN
		SELECT '@DataToProcess - After Validation' as ResultName
		SELECT * FROM @DataToProcess
	END
	
	-- convert the 'yes' input into a bit for table storage
	UPDATE @DataToProcess
		SET [_FreezeBit] = 1
	WHERE [AccountFreeze] = 'Yes'

	UPDATE @DataToProcess
		SET CreditLimit = 0
	WHERE CreditLimit IS NULL
	--
	-- DATA UPDATE
	--
	
	BEGIN TRY
		
		-- this table variable will log the changes to the target table so it can be used
		-- to return helpful feedback to the user about how the save action resulted
		DECLARE @ChangeLog as TABLE
		(
			 [_ExcelRow] INT	-- will capture the source row that affected the target table
			,[UpdateTypeCode] VARCHAR(10)  -- Will show UPDATE, INSERT, or DELETE
			,[TargetTableKey] VARCHAR(5)
		)
		
		BEGIN TRAN t1
			--
			--  use MERGE statement that UPDATES, INSERTS, and DELETES in one action
			--
			MERGE [demo].[Northwind_AccountCredits] t -- t = the target table or view to update
			USING @DataToProcess s -- s = the source data to be used to update the target table
			ON 
				s.[CustomerID] = t.[CustomerID]
				
			WHEN MATCHED -- Handles the update based on INNER JOIN
				AND 
				(
					   t.[CustomerID]		&lt;&gt; s.[CustomerID]
					OR t.[CreditLimit]		&lt;&gt; s.[CreditLimit]
					OR t.[AccountFreeze]	&lt;&gt; s.[_FreezeBit]
					OR t.[AccountNotes]		&lt;&gt; s.[AccountNotes]

				)
				THEN
				UPDATE SET
					 t.[CustomerID]		 = s.[CustomerID]
					,t.[CreditLimit]	 = s.[CreditLimit]
					,t.[AccountFreeze]	 = s.[_FreezeBit]
					,t.[AccountNotes]	 = s.[AccountNotes]
					,t.[LastChangedBy]	 = @Interject_NTLogin
					,t.[LastChangedDate] = @NowUTC
			WHEN NOT MATCHED BY TARGET THEN -- Handles the insert based on LEFT JOIN 
			INSERT (
				 [CustomerID]		
				,[CreditLimit]		
				,[AccountFreeze]	
				,[AccountNotes]
				,[LastChangedBy]
				,[LastChangedDate]
			)
			VALUES (
				 s.[CustomerID]
				,s.[CreditLimit]
				,s.[_FreezeBit]
				,s.[AccountNotes]
				,@Interject_NTLogin
				,@NowUTC
			)
				
			-- the output captures the changes to the table and logs to a table variable
			OUTPUT 
				 isnull(inserted.[CustomerID],deleted.[CustomerID])  -- include deleted in case delete is added later. Inserted is used for both Update an Insert
				,s.[_ExcelRow] 
				,$action as UpdateTypeCode  -- this logs into an a change log table variable
			INTO @ChangeLog
			(
				 [TargetTableKey]
				,[_ExcelRow]
				,[UpdateTypeCode]
			); 
			
			--now we have enough information to update the message to user for each row
			UPDATE dtp
			SET [_MessageToUser] = 
				CASE cl.UpdateTypeCode
					WHEN 'INSERT' THEN ', Added!'  -- not used in this example
					WHEN 'UPDATE' THEN ', Updated!'
				END 
			FROM @DataToProcess dtp
				INNER JOIN @ChangeLog cl 
					 ON dtp.[_ExcelRow] = cl.[_ExcelRow]
				
		IF @TestMode = 1
		BEGIN
			SELECT '@ChangeLog- Show log of changes made' as ResultName
			select * from @ChangeLog
			
			ROLLBACK TRAN t1 -- note this does not roll back changes to table variables, only real tables
			SELECT 'Changes rolled back since in TEST mode!' as TestModeNote
		END
		ELSE
		BEGIN
			COMMIT TRAN t1
		END
	END TRY
	BEGIN CATCH
		IF @@TRANCOUNT &gt; 0
			ROLLBACK TRAN t1
		
		SET @ErrorMessageToUser =  ERROR_MESSAGE()
		GOTO FinalResponseToUser
	END CATCH
	
FinalResponseToUser:
--
-- PROVIDE RESPONSE TO THE SAVE ACTION
--
	
	-- if test mode, show the final table 
	IF @TestMode = 1 
	BEGIN
		SELECT '@DataToProcess - After Validation' as ResultName
		SELECT * FROM @DataToProcess
	END
	
	-- return the recordset results back to the spreadsheet, if needed.
	SELECT
		 [_ExcelRow] as [Row] -- this relates to the original row of the spreadsheet the data came from
		,SUBSTRING([_MessageToUser],3,1000) as [MessageToUser]  -- This is a field that, if it matches a column in the Results Range, will be placed in that column for the specified row
	FROM @DataToProcess
	
	-- if there is an error, raise error and Interject will catch and present to the user.
	-- Note that this is specifically done after the above resultset is returned, since initiating an error before
	-- will not allow a result set to be returned to provide feedback on each row 
	IF @ErrorMessageToUser &lt;&gt; ''
	BEGIN
		-- by adding 'UserNotice:' as a prefix to the message, Interject will not consider it a unhandled error 
		-- and will present the error to the user in a message box.
		SET @ErrorMessageToUser = 'UserNotice:' + @ErrorMessageToUser
		
		RAISERROR (@ErrorMessageToUser,
		18, -- Severity,
		1) -- State)
		RETURN
	END
</code></pre></div></div>

<h3 id="testing-the-stored-procedure">Testing the Stored Procedure</h3>

<p>For quick testing, click on the  <strong>View SQL Test</strong> and copy the test code to the development area. For more information, go to the <a href="/wGetStarted/Troubleshooting-Reports_359563279.html"> common troubleshooting page </a> .</p>

<p><img src="attachments/324665351/363888730.jpg" alt="" /></p>

<p>Now that you have modified the stored procedure, go back to excel and see if the data gets correctly saved.</p>

<p><img src="attachments/324665351/363823174.jpg" alt="" /></p>

<p>After the save, there will be a return message telling what was changed based on the row.</p>

<p><img src="attachments/324665351/363987135.jpg" alt="" /></p>

							<!-- tags -->
							
							
							
							
							
							<!-- link corrections -->
              <script language="JavaScript">
							var x = document.links.length;
							var baseHref = document.getElementsByTagName('base')[0].href
							for (i = 0; i < x; i++) {
							  var munged = false;
							  var thisHREF = document.links[i].href;
							  var originalURL = "/wGetStarted/324665351.html";
							  if (thisHREF.indexOf(baseHref + "#") > -1) {
							    // hash fix
							    //console.log('BEFORE: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							    thisHREF = originalURL + thisHREF.replace(baseHref, "");
							    //console.log('AFTER: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							  }
							  if ((thisHREF.indexOf(window.location.hostname) > -1 || thisHREF.indexOf('http') == -1) && document.links[i].className.indexOf("nomunge") < 0) {
							    munged = true;
							    thisHREF = thisHREF.replace(".md", "/").replace("/index/", "/");
							    document.links[i].setAttribute('href', thisHREF);
							  }
							}
							</script>
							
						  <div id="ratings-div" style="color:#b9c2cc; text-align: center; margin-top: 150px; visibility: hidden">
								<div id="pd_rating_holder_8453675"></div>
								<script type="text/javascript">
									PDRTJS_settings_8453675 = {
										"id": "8453675",
										"unique_id": "wGetStarted/324665351.md",
										"title": "Interject Documentation > L14.1 Dev> Customer Credit Save",
										"permalink": "https://github.com/gointerject/gointerject.github.io/blob/master/wGetStarted/324665351.md"
									};
									(function(d, c, j) {
										if (!document.getElementById(j)) {
											var pd = d.createElement(c),
												s;
											pd.id = j;
											pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
											s = document.getElementsByTagName(c)[0];
											s.parentNode.insertBefore(pd, s);
										}
									}(document, 'script', 'pd-rating-js'));
								</script>
							</div>
							
						</section>
					</main>
					<nav class="col-nav">
						<div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
						<div id="navbar" class="nav-sidebar">
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

						</div>
					</nav>
					<div class="col-toc">
							<div class="sidebar hidden-xs hidden-sm">
							<div class="toc-nav">
								<div class="feedback-links">
									<ul>
										
                                            <li style="visibility: show">
                                                <a href="https://github.com/gointerject/gointerject.github.io/edit/master/wGetStarted/324665351.md">
                                                    <i class="fa fa-pencil-square-o" aria-hidden="true"></i> Edit this page
                                                </a>
                                            </li>
                                        
										<li><a href="https://github.com/gointerject/gointerject.github.io/issues/new?body=File: [wGetStarted/324665351.md](https://docs.gointerject.com/wGetStarted/324665351.html)"
															class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> Request docs changes</a></li>
										<li><a href="http://www.gointerject.com/call-us/"><i class="fa fa-question" aria-hidden="true"></i> Get support</a></li>
										<!-- toggle mode -->
										<!-- Turn night mode on and off
										<li>
											<div class="toggle-mode">
												<div class="icon">
													<i class="fa fa-sun-o" aria-hidden="true"></i>
												</div>
												<div class="toggle-switch">
													<label class="switch">
														<input type="checkbox" id="switch-style">
														<div class="slider round"></div>
												</label>
												</div>
												<div class="icon">
													<i class="fa fa-moon-o" aria-hidden="true"></i>
												</div>
											</div>
										</li>
										-->
									</ul>
								</div>
								   
									<div id="side-toc-title">On this page:</div>
									
<ul id="my_toc" class="inline_toc">
  <li><a href="/wGetStarted/324665351.html#overview" class="nomunge">Overview:</a>
    <ul>
      <li><a href="/wGetStarted/324665351.html#setting-up-the-data-portals" class="nomunge">Setting up the Data Portals:</a></li>
      <li><a href="/wGetStarted/324665351.html#setting-up-formula-parameters" class="nomunge">Setting up Formula Parameters:</a></li>
      <li><a href="/wGetStarted/324665351.html#setting-up-system-parameters" class="nomunge">Setting up System Parameters:</a></li>
      <li><a href="/wGetStarted/324665351.html#creating-the-report" class="nomunge">Creating the Report:</a></li>
      <li><a href="/wGetStarted/324665351.html#creating-the-stored-procedure" class="nomunge">Creating the Stored Procedure</a></li>
      <li><a href="/wGetStarted/324665351.html#testing-the-stored-procedure" class="nomunge">Testing the Stored Procedure</a></li>
    </ul>
  </li>
</ul>


								</div>
								
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- The Modal for viewing images -->
	<div id="modal-main" class="modal" >
		<img class="modal-content nohover" id="modal-img" style="padding-top: 3%;"/>
		<span class="close-modal" style="padding-top: 3%;">
			<i class="fa fa-times-circle fa-1x"></i>
		</span>
	</div>

	
	<footer class="footer">
		  
    <div class="container">
        <div id="footerdiv" class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><h4>GENERAL</h4></li>
                        <li><a href="http://www.gointerject.com">INTERJECT HOME</a></li>
                        <li><a href="http://www.gointerject.com/#whatwedobest">WHAT WE DO BEST</a></li>
                        <li><a href="https://gointerject.com/#benefitsyoucanbankon">BENFITS</a></li>
                        <li><a href="https://gointerject.com/#whatourclientssay">WHAT OUR CLIENTS SAY</a></li>
                        <li><a href="https://gointerject.com/#upcomingevents">UPCOMING EVENTS</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://gointerject.com/#whatmatterstous"><h4>WHAT MATTERS TO US</h4> </a></li>
                        <li><a href="https://gointerject.com/helping-you-master-technology/">Mastering Technology</a></li>
                        <!--<li><a href="https://gointerject.com/helping-you-master-technology/">Attend Next Event</a></li>-->
                        <li><a href="https://gointerject.com/helping-you-master-technology/learn-on-your-own/">Learn On Your Own</a></li>
                        <li><a href="http://www.gointerject.com/kids-coding-clubs/">Kids Coding Club</a></li>
                        <li><a href="http://www.gointerject.com/helping-you-master-technology/">Tech Talks</a></li> 
                        <!-- <li><a href="http://www.gointerject.com/#whatwedobest">Reserve Your Spot</a></li> -->
                        <li><a href="https://gointerject.com/kids-coding-clubs/start-your-own-club/">Start Your Own Club</a></li>
                        <!-- <li><a href="https://gointerject.com/#whatmatterstous">Never Standing Still</a></li>  -->
                        <li><a href="https://gointerject.com/never-stand-still-blog/">Our Blog</a></li> 
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><h4>YOUR TEAM</h4></li>
                        <li><a href="https://gointerject.com/meet-us/">Meet Us</a></li>
                        <li><a href="https://gointerject.com/join-us/">Join Us</a></li>
                        <li><a href="https://gointerject.com/call-us/">Call Us</a></li>
                        <li><h4>SUPPORT</h4></li>
                        <li><a href="">Wiki / FAQ</a><span style="font-size:10px;padding-left: 7px;">(Coming Soon)</span></li>
                        <li><a href="">For Developers</a><span style="font-size:10px;padding-left: 7px;">(Coming Soon)</span></li>
                        <!-- <li class="break"></li> -->
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><h4>CONTACT INFO</h4></li>
                        <li><strong>Office:</strong> (855) 546-0036</li>
                        <li><strong>Fax:</strong>  (360) 838-9459</li>
                        <li><strong>Address:</strong> 1404 NE 134th St. Suite 200, </li>
                        <li>Vancouver, WA 98685</li> 
                        <li><strong>E-mail:</strong> info@gointerject.com</li>
                    </ul>
                </div>
            </div>
            
            <!-- ****** This Section is setup for 'the fine text' links ****** -->
            <!--
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="">Status</a></li>
                        <li><a href="">Security</a></li>
                        <li><a href="">Legal</a></li>
                    </ul>
                </nav>
            </div>
            -->
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright © 2018 INTERJECT Inc. All Rights Reserved.
                </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/gointerject">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/gointerject">Youtube</a></li> 
                    <li class="fa fa-github"><a href="https://github.com/gointerject">Github</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/gointerject">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/gointerject">Facebook</a></li>  
                </ul>
            </div>
        </div>
    </div>

	</footer>
	<link rel="stylesheet" href="/css/github.css">
	
	<!-- <script src="/js/anchorlinks.js"></script> -->
	<script defer src="/js/menu.js"></script>
	<script src="/js/jquery.js"></script>
	<script src="/js/bootstrap.min.js"></script>
	<!-- Always include the archive.js, but it doesn't do much unless we are an archive -->
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var interjectVersion = 'v';
	// In archives, we need to know the page root and we get it from JEKYLL_ENV in the jekyll build command
	var jekyllEnv = 'development';
	// If unset (in non-archive branches), defaults to "development". In that case, reset it to empty
	if (jekyllEnv == 'development') {
		jekyllEnv = '';
	}
	var pageURL = jekyllEnv + '/wGetStarted/324665351.html';
	</script>
	<script src="/js/archive.js"></script>
	<script src="/js/stickyfill.min.js"></script>
	<script defer src="/js/metadata.js"></script>
	<script src="/js/glossary.js"></script>
	<script src="/js/collections_tocs.js"></script>
	<script defer src="/js/docs.js"></script>
	<script defer src="/js/toc.js"></script>
	<script defer src="/js/stylemod.js"></script>
	<script language="javascript">
	jQuery(document).ready(function(){
				hookupTOCEvents();
			});
	</script>
</body>

</html>
