
<!-- Page generated 2018-11-21 14:32:27 -0800 -->
<!-- relative link basehrefs -->

	
	
	
		
			
		
	
		
			
			


<!-- Logic for 'edit this button' -->



<!-- End of logic for 'edit this button' -->


<!DOCTYPE html>
<html lang="en">

<head>
	<base href="/wGetStarted/" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<style id="page_style" type="text/css">
		@charset "UTF-8";
		[ng\:cloak],
		[ng-cloak],
		[data-ng-cloak],
		[x-ng-cloak],
		.ng-cloak,
		.x-ng-cloak,
		.ng-hide:not(.ng-hide-animate) {
			display: none !important;
		}

		ng\:form {
			display: block;
		}
	</style>

	<!--
	<script type="text/javascript">
	  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="4.0.0";
	  analytics.load("IWj9D0UpZHZdZUZX9jl98PcpBFWBnBMy");
	  analytics.page();
	  }}();
	</script>
	-->
	
	<!-- favicon -->
	<link rel="icon" type="image/x-icon" href="/favicons/docs@2x.ico" sizes="129x128">
	<meta name="msapplication-TileImage" content="/favicons/docs@2x.ico">
	<link rel="apple-touch-icon" type="image/x-icon" href="/favicons/docs@2x.ico" sizes="129x128">
	<meta property="og:image" content="/favicons/docs@2x.ico"/>
	<!-- metadata -->
	

    <link rel="stylesheet" href="/css/font-awesome.min.css">
	<link rel="stylesheet" href="/css/bootstrap.min.css">
	<link id="pygments" rel="stylesheet" href="/css/pygments/perldoc.css">
	<link id="pagestyle" rel="stylesheet" href="/css/style.css">

	<!-- Go get "Open Sans" font from Google -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
	
	
	

</head>	

<body id="main_body" class="colums">
	

	<header>
		 <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="/"><img class="logo" src="/images/site-logo.png" alt="Interject Docs" title="Interject Docs"></a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="search-form" id="search-div" >
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="Search the docs" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">Search</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container">
    <div id="tabs">
        <ul class="tabs" id="jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right hidden-xs hidden-sm">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="btn-group" style="visibility: hidden">
  <button type="button" class="btn btn-default dropdown-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    
  </ul>
</div>

    </div>
</div>

        </div>
    </div>
</nav>
	</header>

	

	<!-- nav bar -->
	<div class="wrapper right-open">
		<div class="container-fluid">
			<div class="row">
				<div class="col-body">
					<main class="col-content content">
						<section class="section">
							
								
							<h1>Interject Documentation > L12.2 Dev> Customer Orders</h1> 
									 
									
									<span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">Estimated reading time: </span>
  
  
    5 minutes
  
</span>

									
							
							
							<hr />

<h2 id="-">** **</h2>

<h2 id="overview"><strong>Overview</strong></h2>

<p>In this example, you will how to create a second report, Customer Orders, that will be drilled to from the Customer Aging Report you built in the last lab. You should have already seen the Customer Orders report while reviewing the business use case in the lab. Continue to build the INTERJECT configuration and database objects to support the report.</p>

<p>Go directly to any topic of this walk-through by clicking one of the links below.</p>

<ul>
  <li>** Verifying the Data Connection  **</li>
  <li>** Copy the Data Portal  **</li>
  <li>** Creating the Stored Procedure  **</li>
  <li>** Creating the Report  **</li>
</ul>

<p>###</p>

<h3 id="verifying-the-data-connection">Verifying the Data Connection</h3>

<p>Because this report uses the same database as the previous example, you do not need to create another data connection. The same connection can be used for this report. The connection created in the example text was named <strong>NorthwindExampleDB_MyName</strong> and  you should use the same naming conventions for your connection  .</p>

<p>###</p>

<h3 id="copy-the-data-portal">Copy the Data Portal</h3>

<p><strong>Step 1:</strong> Navigate to the data portal, <strong>NorthwindCustomers_MyName</strong> , and click the green clone button on the top right corner of the page.</p>

<p><img src="attachments/324403205/328335967.png" alt="" /></p>

<p><strong>Step 2:</strong> A new data portal named, <strong>NorthwindCustomers_MyName_copy</strong> , generates. Change this data portal name to <strong>NorthwindOrders_MyName</strong> . Since each Data Portal must have a unique code, please use your name instead of <strong>_MyName</strong> . Then click Save Changes</p>

<p><img src="attachments/324403205/328466929.png" alt="" /></p>

<p><strong>Step 3:</strong> Change the procedure name to run <strong>[Demo].[Northwind_CustomerOrders_Pull_MyName]</strong> , which you will create next. Then click <strong>Save Changes</strong> .</p>

<p><img src="attachments/324403205/328138962.jpg" alt="" /></p>

<p>###</p>

<h3 id="creating-the-stored-procedure">Creating the Stored Procedure</h3>

<p>A stored procedure or data API servers as a middle tier for an INTERJECT report. In this example, you are using a stored procedure. INTERJECT can retrieve one or more result sets from the stored procedure into the spreadsheet report.</p>

<p>The INTERJECT Website Portal allows you to create and manage data portals and reference stored procedures you create. Data portals are stored locally in your Excel session when you log into INTERJECT. When requesting data, INTERJECT creates a point-to-point connection with the intended data source.</p>

<p>The steps below assume you are proficient with SQL Management Studio for Microsoft SQL Server and in creating stored procedures. If you need additional training in this area, please contact us at <a href="mailto:info@gointerject.com"> info@gointerject.com </a> .</p>

<p><strong>Step 1:</strong> Create a stored procedure called [demo].[Northwind_CustomerOrders_Pull_MyName] using the following code:</p>

<p><strong>Customer Orders</strong> Expand source</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CREATE PROC [demo].[Northwind_CustomerOrders_Pull_MyName]

	 @CompanyName						VARCHAR(100)
	,@ContactName						VARCHAR(100)
	,@CustomerID						VARCHAR(500) = ''
	,@Interject_NTLogin					VARCHAR(10)
	,@Interject_LocalTimeZoneOffset		MONEY

AS
BEGIN

SET NOCOUNT ON  -- helps reduce conflicts with ADO

DECLARE @ErrorMessage VARCHAR(100)

IF LEN(@CompanyName)&gt;40
BEGIN
	SET @ErrorMessage = 'Usernotice:The company search text must not be more than 40 characters.'
	RAISERROR (@ErrorMessage, 18, 1)
	RETURN		
END

SELECT 
	 c.[CustomerID]
	,c.[CompanyName]
	,c.[ContactName]
	,c.[Country]
	,o.[OrderID]
	,o.[OrderDate]
	,o.[ShipCity]
	,o.[ShipCountry]
	,s.[CompanyName] AS ShipVia
	,o.[ShippedDate]
	,SUM(d.[UnitPrice] * cast(d.[Quantity] AS MONEY) * (cast(1 AS MONEY) -d.[Discount])) AS OrderAmount
	,o.[Freight]
	,SUM(d.[UnitPrice] * cast(d.[Quantity] AS MONEY) * (cast(1 AS MONEY) -d.[Discount])) + o.[Freight] AS TotalAmount
FROM [demo].[Northwind_Orders] o
	INNER JOIN [demo].[Northwind_Customers] c
		ON o.[CustomerID] = c.[CustomerID]
	INNER JOIN [demo].[Northwind_Shippers] s
		ON o.[ShipVia] = s.[ShipperID]
	INNER JOIN [demo].[Northwind_Order Details] d
		ON o.[OrderID] = d.[OrderID]
WHERE 
	(@CompanyName='' OR c.CompanyName LIKE '%' + @CompanyName + '%')
	and
	(@ContactName='' OR c.ContactName LIKE '%' + @ContactName + '%')
	and
	(@CustomerID='' OR c.[CustomerID] = @CustomerID)
GROUP BY
	 c.[CustomerID]
	,c.[CompanyName]
	,c.[ContactName]
	,c.[Country]
	,o.[OrderID]
	,o.[OrderDate]
	,o.[ShipName]
	,o.[ShipCity]
	,o.[ShipCountry]
	,s.[CompanyName]
	,o.[ShippedDate]
	,o.[Freight]
ORDER BY c.[CompanyName], o.[OrderID]  DESC

END
</code></pre></div></div>

<p><strong>Step 2:</strong> INTERJECT supports stored procedures natively. Here are a few key areas to note in the code above that help illustrate INTERJECT features.</p>

<ul>
  <li>Parameters: The parameters included in the stored procedure are the same parameters added to the data portal in a previous step. For each request, INTERJECT passes the formula parameter values from the spreadsheet configuration, along with system parameters, to the stored procedure. Output parameters are supported and can populate values in the spreadsheet, but they are not included in this example.</li>
</ul>

<p><img src="attachments/324403205/328564763.png" alt="" /></p>

<ul>
  <li>Validation: The code above includes an example of validating the input from the formula parameter, <strong>@CustomerName</strong> . It limits the search text to 40 characters and displays an error when the length is exceeded. This error has a prefix, <strong>UserNotice:</strong> which tells INTERJECT to provide a message box with the text to the user as a response. Without the prefix, INTERJECT interprets the error as a generic error.</li>
</ul>

<p><img src="attachments/324403205/328597548.png" alt="" /></p>

<ul>
  <li>Select statements: Returning data to INTERJECT simply uses a select statement as shown below. More than one select statement can be returned at a time to reduce the connections needed to fully populate a complex report. You only have one select statement in this example.</li>
</ul>

<p><img src="attachments/324403205/328597553.png" alt="" /></p>

<p><strong>Step 3:</strong> It is important to test the stored procedure in the database before testing through the INTERJECT platform. The code below is an example that includes a test SQL statement.</p>

<p><strong>Customer Orders Test Code</strong> Expand source</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Execute demo.[Northwind_CustomerOrders_Pull_MyName]
	@CompanyName = 'market'
	,@ContactName = ''
	,@CustomerID = ''
	,@Interject_NTLogin = 'MaryM'
	,@Interject_LocalTimeZoneOffset = -7
</code></pre></div></div>

<p>When this code is executed, it returns the following result set.</p>

<p><img src="attachments/324403205/328335379.png" alt="" /></p>

<p>Back to Top</p>

<h3 id="create-the-report">Create The Report:</h3>

<p>At this point you have a tested stored procedure that uses parameters to filter the results. An INTERJECT Data Connection is setup to go to your example database and you added an INTERJECT Data Portal to use that connection and is mapped to the stored procedure that was just created. You are ready to build the spreadsheet report.</p>

<p>Fortunately, the documentation to build this report has already been presented in <strong>Create: Customer Orders</strong> and you likely have already completed it. The end result should look like the below screenshot.</p>

<p><img src="attachments/324403205/328597528.png" alt="" /></p>

<p>It is recommended to go to <strong>Create: Customer Orders</strong> to complete those steps again to reinforce the process. However, this time you can use your own Data Portal for the report.</p>

<p>Back to Top</p>

							<!-- tags -->
							
							
							
							
							
							<!-- link corrections -->
              <script language="JavaScript">
							var x = document.links.length;
							var baseHref = document.getElementsByTagName('base')[0].href
							for (i = 0; i < x; i++) {
							  var munged = false;
							  var thisHREF = document.links[i].href;
							  var originalURL = "/wGetStarted/324403205.html";
							  if (thisHREF.indexOf(baseHref + "#") > -1) {
							    // hash fix
							    //console.log('BEFORE: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							    thisHREF = originalURL + thisHREF.replace(baseHref, "");
							    //console.log('AFTER: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							  }
							  if ((thisHREF.indexOf(window.location.hostname) > -1 || thisHREF.indexOf('http') == -1) && document.links[i].className.indexOf("nomunge") < 0) {
							    munged = true;
							    thisHREF = thisHREF.replace(".md", "/").replace("/index/", "/");
							    document.links[i].setAttribute('href', thisHREF);
							  }
							}
							</script>
							
						  <div id="ratings-div" style="color:#b9c2cc; text-align: center; margin-top: 150px; visibility: hidden">
								<div id="pd_rating_holder_8453675"></div>
								<script type="text/javascript">
									PDRTJS_settings_8453675 = {
										"id": "8453675",
										"unique_id": "wGetStarted/324403205.md",
										"title": "Interject Documentation > L12.2 Dev> Customer Orders",
										"permalink": "https://github.com/gointerject/gointerject.github.io/blob/master/wGetStarted/324403205.md"
									};
									(function(d, c, j) {
										if (!document.getElementById(j)) {
											var pd = d.createElement(c),
												s;
											pd.id = j;
											pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
											s = document.getElementsByTagName(c)[0];
											s.parentNode.insertBefore(pd, s);
										}
									}(document, 'script', 'pd-rating-js'));
								</script>
							</div>
							
						</section>
					</main>
					<nav class="col-nav">
						<div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
						<div id="navbar" class="nav-sidebar">
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

						</div>
					</nav>
					<div class="col-toc">
							<div class="sidebar hidden-xs hidden-sm">
							<div class="toc-nav">
								<div class="feedback-links">
									<ul>
										
                                            <li style="visibility: show">
                                                <a href="https://github.com/gointerject/gointerject.github.io/edit/master/wGetStarted/324403205.md">
                                                    <i class="fa fa-pencil-square-o" aria-hidden="true"></i> Edit this page
                                                </a>
                                            </li>
                                        
										<li><a href="https://github.com/gointerject/gointerject.github.io/issues/new?body=File: [wGetStarted/324403205.md](https://docs.gointerject.com/wGetStarted/324403205.html)"
															class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> Request docs changes</a></li>
										<li><a href="http://www.gointerject.com/call-us/"><i class="fa fa-question" aria-hidden="true"></i> Get support</a></li>
										<!-- toggle mode -->
										<!-- Turn night mode on and off
										<li>
											<div class="toggle-mode">
												<div class="icon">
													<i class="fa fa-sun-o" aria-hidden="true"></i>
												</div>
												<div class="toggle-switch">
													<label class="switch">
														<input type="checkbox" id="switch-style">
														<div class="slider round"></div>
												</label>
												</div>
												<div class="icon">
													<i class="fa fa-moon-o" aria-hidden="true"></i>
												</div>
											</div>
										</li>
										-->
									</ul>
								</div>
								   
									<div id="side-toc-title">On this page:</div>
									
<ul id="my_toc" class="inline_toc">
  <li><a href="/wGetStarted/324403205.html#-" class="nomunge">** **</a></li>
  <li><a href="/wGetStarted/324403205.html#overview" class="nomunge">Overview</a>
    <ul>
      <li><a href="/wGetStarted/324403205.html#verifying-the-data-connection" class="nomunge">Verifying the Data Connection</a></li>
      <li><a href="/wGetStarted/324403205.html#copy-the-data-portal" class="nomunge">Copy the Data Portal</a></li>
      <li><a href="/wGetStarted/324403205.html#creating-the-stored-procedure" class="nomunge">Creating the Stored Procedure</a></li>
      <li><a href="/wGetStarted/324403205.html#create-the-report" class="nomunge">Create The Report:</a></li>
    </ul>
  </li>
</ul>


								</div>
								
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- The Modal for viewing images -->
	<div id="modal-main" class="modal" >
		<img class="modal-content nohover" id="modal-img" style="padding-top: 3%;"/>
		<span class="close-modal" style="padding-top: 3%;">
			<i class="fa fa-times-circle fa-1x"></i>
		</span>
	</div>

	
	<footer class="footer">
		  
    <div class="container">
        <div id="footerdiv" class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><h4>GENERAL</h4></li>
                        <li><a href="http://www.gointerject.com">INTERJECT HOME</a></li>
                        <li><a href="http://www.gointerject.com/#whatwedobest">WHAT WE DO BEST</a></li>
                        <li><a href="https://gointerject.com/#benefitsyoucanbankon">BENFITS</a></li>
                        <li><a href="https://gointerject.com/#whatourclientssay">WHAT OUR CLIENTS SAY</a></li>
                        <li><a href="https://gointerject.com/#upcomingevents">UPCOMING EVENTS</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://gointerject.com/#whatmatterstous"><h4>WHAT MATTERS TO US</h4> </a></li>
                        <li><a href="https://gointerject.com/helping-you-master-technology/">Mastering Technology</a></li>
                        <!--<li><a href="https://gointerject.com/helping-you-master-technology/">Attend Next Event</a></li>-->
                        <li><a href="https://gointerject.com/helping-you-master-technology/learn-on-your-own/">Learn On Your Own</a></li>
                        <li><a href="http://www.gointerject.com/kids-coding-clubs/">Kids Coding Club</a></li>
                        <li><a href="http://www.gointerject.com/helping-you-master-technology/">Tech Talks</a></li> 
                        <!-- <li><a href="http://www.gointerject.com/#whatwedobest">Reserve Your Spot</a></li> -->
                        <li><a href="https://gointerject.com/kids-coding-clubs/start-your-own-club/">Start Your Own Club</a></li>
                        <!-- <li><a href="https://gointerject.com/#whatmatterstous">Never Standing Still</a></li>  -->
                        <li><a href="https://gointerject.com/never-stand-still-blog/">Our Blog</a></li> 
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><h4>YOUR TEAM</h4></li>
                        <li><a href="https://gointerject.com/meet-us/">Meet Us</a></li>
                        <li><a href="https://gointerject.com/join-us/">Join Us</a></li>
                        <li><a href="https://gointerject.com/call-us/">Call Us</a></li>
                        <li><h4>SUPPORT</h4></li>
                        <li><a href="">Wiki / FAQ</a><span style="font-size:10px;padding-left: 7px;">(Coming Soon)</span></li>
                        <li><a href="">For Developers</a><span style="font-size:10px;padding-left: 7px;">(Coming Soon)</span></li>
                        <!-- <li class="break"></li> -->
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><h4>CONTACT INFO</h4></li>
                        <li><strong>Office:</strong> (855) 546-0036</li>
                        <li><strong>Fax:</strong>  (360) 838-9459</li>
                        <li><strong>Address:</strong> 1404 NE 134th St. Suite 200, </li>
                        <li>Vancouver, WA 98685</li> 
                        <li><strong>E-mail:</strong> info@gointerject.com</li>
                    </ul>
                </div>
            </div>
            
            <!-- ****** This Section is setup for 'the fine text' links ****** -->
            <!--
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="">Status</a></li>
                        <li><a href="">Security</a></li>
                        <li><a href="">Legal</a></li>
                    </ul>
                </nav>
            </div>
            -->
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright © 2018 INTERJECT Inc. All Rights Reserved.
                </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/gointerject">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/gointerject">Youtube</a></li> 
                    <li class="fa fa-github"><a href="https://github.com/gointerject">Github</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/gointerject">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/gointerject">Facebook</a></li>  
                </ul>
            </div>
        </div>
    </div>

	</footer>
	<link rel="stylesheet" href="/css/github.css">
	
	<!-- <script src="/js/anchorlinks.js"></script> -->
	<script defer src="/js/menu.js"></script>
	<script src="/js/jquery.js"></script>
	<script src="/js/bootstrap.min.js"></script>
	<!-- Always include the archive.js, but it doesn't do much unless we are an archive -->
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var interjectVersion = 'v';
	// In archives, we need to know the page root and we get it from JEKYLL_ENV in the jekyll build command
	var jekyllEnv = 'development';
	// If unset (in non-archive branches), defaults to "development". In that case, reset it to empty
	if (jekyllEnv == 'development') {
		jekyllEnv = '';
	}
	var pageURL = jekyllEnv + '/wGetStarted/324403205.html';
	</script>
	<script src="/js/archive.js"></script>
	<script src="/js/stickyfill.min.js"></script>
	<script defer src="/js/metadata.js"></script>
	<script src="/js/glossary.js"></script>
	<script src="/js/collections_tocs.js"></script>
	<script defer src="/js/docs.js"></script>
	<script defer src="/js/toc.js"></script>
	<script defer src="/js/stylemod.js"></script>
	<script language="javascript">
	jQuery(document).ready(function(){
				hookupTOCEvents();
			});
	</script>
</body>

</html>
