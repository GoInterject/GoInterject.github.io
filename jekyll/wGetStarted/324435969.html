---
title: Interject Documentation > L13.1 Dev> Customer Aging Detail
layout: custom
---
<div class="wiki-content group" id="main-content">
 <hr/>
 <div id="#main-content">
  <h2 id="L13.1Dev:CustomerAgingDetail-Overview">
   <strong>
    Overview
   </strong>
  </h2>
  <p>
   In this example, you will learn to create a third report, Customer Aging Detail, that will be drilled to from the Customer Aging Report. This report shows a customer's outstanding balance by individual invoice. The Aging Detail is a more complex report than shown in the earlier lab
   <a href="https://interject.atlassian.net/wiki/spaces/ID/pages/324403205/L12.2+Dev+Customer+Orders" rel="nofollow">
    Lab 12.2 Dev: Customer Orders
   </a>
   , because it leverages two report formulas to create a report with subtotals. You should have already seen the Customer Aging Detail report while reviewing the business use case in the
   <a href="https://interject.atlassian.net/wiki/spaces/ID/pages/128091294/Customer+Aging" rel="nofollow">
    <strong>
     Customer Aging in Real-World Walkthroughs
    </strong>
   </a>
   .
  </p>
  <p>
   You can go directly to any topic of this walk-through by clicking one of the links below.
  </p>
  <ul>
   <li>
    <h4 id="L13.1Dev:CustomerAgingDetail-VerifyingtheDataConnection">
     <a href="#L13.1Dev:CustomerAgingDetail-VerifyConnections">
      Verifying the Data Connection
     </a>
    </h4>
   </li>
   <li>
    <h4 id="L13.1Dev:CustomerAgingDetail-CopyingandModifyingtheDataPortal">
     <a href="#L13.1Dev:CustomerAgingDetail-CopyingDataPortals">
      Copying and Modifying the Data Portal
     </a>
    </h4>
   </li>
   <li>
    <h4 id="L13.1Dev:CustomerAgingDetail-CreatingtheStoredProcedure">
     <a href="#L13.1Dev:CustomerAgingDetail-CreatingSP">
      Creating the Stored Procedure
     </a>
    </h4>
   </li>
   <li>
    <h4 id="L13.1Dev:CustomerAgingDetail-CreatingtheReport">
     <a href="#L13.1Dev:CustomerAgingDetail-CreateReport">
      Creating the Report
     </a>
    </h4>
   </li>
   <li>
    <h4 id="L13.1Dev:CustomerAgingDetail-CreatingaNewDataPortalfor2Recordsets">
     <a href="#L13.1Dev:CustomerAgingDetail-NewDataPortal">
      Creating a New Data Portal for 2 Recordsets
     </a>
    </h4>
   </li>
   <li>
    <h4 id="L13.1Dev:CustomerAgingDetail-UpdatingtheStoredProcedurefor2Recordsets">
     <a href="#L13.1Dev:CustomerAgingDetail-UpdatingSP">
      Updating the Stored Procedure for 2 Recordsets
     </a>
    </h4>
   </li>
   <li>
    <h4 id="L13.1Dev:CustomerAgingDetail-UpdatingtheReportfor2Recordsets">
     <a href="#L13.1Dev:CustomerAgingDetail-UpdateReport">
      Updating the Report for 2 Recordsets
     </a>
    </h4>
   </li>
  </ul>
  <h3 id="L13.1Dev:CustomerAgingDetail-VerifyConnections">
   <span class="confluence-anchor-link" id="L13.1Dev:CustomerAgingDetail-VerifyConnections">
   </span>
  </h3>
  <h3 id="L13.1Dev:CustomerAgingDetail-VerifyingtheDataConnection.1">
   Verifying the Data Connection
  </h3>
  <p>
   Because this report uses the same database as
   <a href="https://interject.atlassian.net/wiki/spaces/ID/pages/324567045/L12.1+Dev+Customer+Aging" rel="nofollow">
    Dev: Customer Aging Detail
   </a>
   , you do not need to create another data connection. The same connection can be used for this report. The connection created in the previous example was named
   <strong>
    NorthwindExampleDB_MyName
   </strong>
   and your own data connection likely had your name in the suffix.
  </p>
  <p>
   <span class="confluence-anchor-link" id="L13.1Dev:CustomerAgingDetail-CopyingDataPortals">
   </span>
  </p>
  <h3 id="L13.1Dev:CustomerAgingDetail-CopyingandModifyingtheDataPortals">
   Copying and Modifying the Data Portals
  </h3>
  <p>
   For this report you are going to use two data portals. The first will be the same data portal used in a previous example called
   <strong>
    NorthwindCustomers_MyName
   </strong>
   . You created your own with your name in the suffix.  The below steps will create a copy of this data portal for the customer invoice detail since it saves a little time.
  </p>
  <p>
   <strong>
    Step 1:
   </strong>
   Navigate to the data portal,
   <strong>
    NorthwindCustomers_MyName
   </strong>
   , and click the green clone button on the top right of the page.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328303186.png" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-5_11-53-26.png" data-linked-resource-id="328303186" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="e0805788-0bee-4631-a2d0-419925381d94" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328303186.png"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 2:
   </strong>
   A new data portal named,
   <strong>
    NorthwindCustomers_MyName_copy
   </strong>
   , generates. Change this data portal name to
   <strong>
    NorthwindCustomerInvoices_MyName
   </strong>
   .  Since each Data Portal Code must be unique, you should add your name to the suffix.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328269910.jpg" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="CopyinAndModifyinStep2.jpg" data-linked-resource-id="328269910" data-linked-resource-type="attachment" data-linked-resource-version="2" data-media-id="08c63158-8396-466d-b95d-08270b863e91" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328269910.jpg"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 3:
   </strong>
   Change the procedure name to run
   <strong>
    [demo].[Northwind_Invoices_Pull_MyName]
   </strong>
   , which you will create shortly.  As in the last step, replace
   <strong>
    _MyName
   </strong>
   with your own name.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328433982.jpg" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="CopyinAndModifyinStep3.jpg" data-linked-resource-id="328433982" data-linked-resource-type="attachment" data-linked-resource-version="3" data-media-id="cd57b3ba-f687-4c29-89c9-6553741bdcd4" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328433982.jpg"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 4:
   </strong>
   You will use the existing Formula Parameters but for this example you need to add more more. Select
   <strong>
    Click here to add a Formula Parameter
   </strong>
   . Enter
   <strong>
    IncludePaid
   </strong>
   for Name,
   <strong>
    varchar
   </strong>
   for Type, and
   <strong>
    input
   </strong>
   for direction. Click the
   <strong>
    More
   </strong>
   button.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328401105.jpg" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="CopyinAndModifyinStep4.jpg" data-linked-resource-id="328401105" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="6f36aa1f-0170-47bc-a954-943ddd933c00" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328401105.jpg"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   Enter
   <strong>
    Include Paid
   </strong>
   for Helper Name and enter
   <strong>
    Include Invoices that have already been paid for by the customer
   </strong>
   for Comments. Click the Save icon.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328532161.jpg" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="CopyinAndModifyinStep4Additional.jpg" data-linked-resource-id="328532161" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="f08b0ecf-c6b0-495e-b5d3-6fc643606869" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328532161.jpg"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 5:
   </strong>
   Click the trash can icon on the far right of the Interject_LocalTimeZoneOffset to delete it.  You are going to a use a different System Parameter for this data portal to illustrate a new System Parameter that has not been presented in previous examples.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328269915.jpg" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="CopyingAndModifyinStep5.jpg" data-linked-resource-id="328269915" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="d73b7048-5a71-4cc8-9e87-7077344898ca" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328269915.jpg"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 6:
   </strong>
   Click the drop-down on the
   <strong>
    Interject_NTLogin
   </strong>
   and change it
   <strong>
    Interject_RequestContext
   </strong>
   . This System Parameter provides all request and user context that is available in a single XML string.  It is best practices to use
   <strong>
    Interject_RequestContext
   </strong>
   as the only System Parameter since it reduces work over the long run. Since this parameter includes all system parameter information, the data portal configuration does not need to be changed if the stored procedure needs to reference additional context. Click Save.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328564893.jpg" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="CopyinAndModifyinStep6.jpg" data-linked-resource-id="328564893" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="dfc91170-a8db-444c-84a8-9985cbf3fa47" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328564893.jpg"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <h3 id="L13.1Dev:CustomerAgingDetail-CreatingSP">
   <span class="confluence-anchor-link" id="L13.1Dev:CustomerAgingDetail-CreatingSP">
   </span>
  </h3>
  <h3 id="L13.1Dev:CustomerAgingDetail-CreatingtheStoredProcedure.1">
   Creating the Stored Procedure
  </h3>
  <p>
   Stored procedures or data APIs serve as a middle tier for an INTERJECT report. In this example, you are using a stored procedure.  INTERJECT can retrieve one or more result sets from the stored procedure into the spreadsheet report.
  </p>
  <p>
   The INTERJECT Website Portal allows you to create and manage the data portals and reference stored procedures you create. Data portals are stored locally in your Excel session when you log into INTERJECT. When requesting data, INTERJECT creates a point-to-point connection with the intended data source.
  </p>
  <p>
   The steps below assume you are proficient with SQL Management Studio for Microsoft SQL Server and in creating stored procedures. If you need additional training in this area, please contact us at
   <a class="external-link" href="mailto:info@gointerject.com" rel="nofollow">
    info@gointerject.com
   </a>
   .
  </p>
  <p>
   <strong>
    Step 1:
   </strong>
   Create a stored procedure called [demo].[Northwind_Invoices_Pull_MyName] using the following example code.  Please use your name in the suffix of the stored procedure name.
  </p>
  <div class="code panel pdl" style="border-width: 1px;">
   <div class="codeHeader panelHeader pdl hide-border-bottom" style="border-bottom-width: 1px;">
    <b class=" code-title">
     Customer Invoices
    </b>
    <span class="collapse-source expand-control" style="display:none;">
     <span class="expand-control-icon icon">
     </span>
     <span class="expand-control-text">
      Expand source
     </span>
    </span>
    <span class="collapse-spinner-wrapper">
    </span>
   </div>
   <div class="codeContent panelContent pdl hide-toolbar">
    <pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: sql; gutter: true; first-line: 1; theme: Confluence; collapse: true" data-theme="Confluence">CREATE PROC [demo].[Northwind_Invoices_Pull_MyName]

	 @CompanyName VARCHAR(100)
	,@ContactName NVARCHAR(100)
	,@CustomerID VARCHAR(500) = ''
	,@IncludePaid VARCHAR(5) = 0
	,@Interject_RequestContext NVARCHAR(MAX)

AS
BEGIN

SET NOCOUNT ON  -- helps reduce conflicts with ADO

DECLARE @Interject_LoginName VARCHAR(200)
DECLARE @UtcOffset	DECIMAL(6,4)

-- Dataset has very old dates
-- To give a static date to compare to we hard coded the date.
DECLARE @DateCompare VARCHAR(20) = '1997-09-15'
DECLARE @ErrorMessage VARCHAR(100)

IF LEN(@CompanyName)&gt;40
BEGIN
	SET @ErrorMessage = 'Usernotice:The company search text must not be more than 40 characters.'
	RAISERROR (@ErrorMessage, 18, 1)
	RETURN		
END

-- This is another SP that parses the xml in request context to get the needed system data
EXEC [demo].[RequestContext_Parse]
	@Interject_RequestContext		= @Interject_RequestContext	
	,@Interject_LoginName			= @Interject_LoginName	OUTPUT
	,@UtcOffset = @UtcOffset OUTPUT

-- @IncludePaid is default 0.
-- if set to Yes, change it to 1
IF @IncludePaid = 'Yes'
	SET @IncludePaid = 1

-----------------------------------------------
--	REMAINDER OF DATA QUERY
-----------------------------------------------
--Create CTE that sorts data by InvoiceDate's difference from the hardcoded DateCompare
;WITH Invoice_CTE
AS
(
    SELECT 
		 [CustomerID]
		,[InvoiceID]
		,[InvoiceNum]
		,[InvoiceTotal]
		,[Current]
		,[30Days]
		,[60Days]
		,[90Days]
		,[IsPaid]
	FROM 
	(
		SELECT 
			 i.[CustomerID]
			,i.[InvoiceID]
			,i.[InvoiceNum]
			,i.[InvoiceDate]
			,i.[InvoiceTotal]
			,CASE WHEN DATEDIFF(dd,InvoiceDate,@DateCompare) &lt; 30 THEN (i.[InvoiceTotal]) ELSE 0 END AS [Current]
			,CASE WHEN DATEDIFF(dd,InvoiceDate,@DateCompare) BETWEEN 30 AND 59 THEN (i.[InvoiceTotal]) ELSE 0 END AS [30Days]
			,CASE WHEN DATEDIFF(dd,InvoiceDate,@DateCompare) BETWEEN 60 AND 89 THEN (i.[InvoiceTotal]) ELSE 0 END AS [60Days]
			,CASE WHEN DATEDIFF(dd,InvoiceDate,@DateCompare) &gt; 90 THEN (i.[InvoiceTotal]) ELSE 0 END AS [90Days]
			,@IncludePaid AS IsPaid
		FROM [demo].[Northwind_Invoices] i
	) t
	WHERE [IsPaid] = @IncludePaid
	GROUP BY [CustomerID]
			,[InvoiceID] 
			,[InvoiceNum]
			,[InvoiceTotal]
			,[Current]
			,[30Days]
			,[60Days]
			,[90Days]
			,[IsPaid]
)
-- Final Select statement
SELECT
	 c.[CustomerID]
	,c.[CompanyName]
	,c.[ContactName]
	,c.[ContactTitle]
	,c.[Country]
	,i.[InvoiceID]
	,i.[InvoiceNum]
	,i.[InvoiceDate]
	,i.[OrderTotal]
    ,i.[Freight]
    ,i.[InvoiceTotal]
	,i.[BillName]
    ,i.[BillAddress]
    ,i.[BillCity]
    ,i.[BillCountry]
	,i.[IsPaid]
	,o.[OrderID]
	,cte.[IsPaid]
	,cte.[Current]
	,cte.[30Days]
	,cte.[60Days]
	,cte.[90Days]
	,p.[PaidAmount]
	,n.[KeyValue] AS Note
	,d.[KeyValue] AS ExpectedDate
FROM [demo].[Northwind_Invoices] i
LEFT JOIN [demo].[Northwind_Customers] c
	ON i.[CustomerID] = c.[CustomerID]
LEFT JOIN Invoice_CTE cte
	ON cte.[InvoiceID] = i.[InvoiceID]
LEFT JOIN demo.Northwind_Payments p
	ON i.[InvoiceID] = p.[InvoiceID]
LEFT JOIN demo.Northwind_Orders o
	ON o.[CustomerID] = i.[CustomerID]
	AND o.[Freight] = i.[Freight]
LEFT JOIN demo.Northwind_InvoiceExternal n
	ON n.[InvoiceID] = i.[InvoiceID]
	AND n.[KeyName] = 'NOTE'
LEFT JOIN demo.Northwind_InvoiceExternal d
	ON d.[InvoiceID] = i.[InvoiceID]
	AND d.[KeyName] = 'ExpectedDate'
WHERE 
	i.IsPaid = @IncludePaid
	AND
	(@CompanyName='' OR c.[CompanyName] LIKE '%' + @CompanyName + '%')
	AND
	(@ContactName='' OR c.[ContactName] LIKE '%' + @ContactName + '%')
	AND
	(@CustomerID='' OR c.[CustomerID] = @CustomerID)
ORDER BY c.[CompanyName]
		,i.[InvoiceDate]
		,i.[InvoiceID]

END</pre>
   </div>
  </div>
  <p>
   <br/>
  </p>
  <p>
   It is important to test the stored procedure in the database before testing it through the INTERJECT platform. Using Interject_RequestContext requires the test scripts to be much longer than in the previous steps.  To help with this extra text INTERJECT will create the test code for you using the current users context.
  </p>
  <p>
   <strong>
    Step 2:
   </strong>
   First you must select a report formula that uses the data portal that is mapped to the stored procedure you want to test. You can quickly make a report formula and delete it since you are not creating the spreadsheet report yet.  In a spreadsheet tab, in any cell, type
   <strong>
    =ReportVariable("NorthwindCustomerInvoices",A42:A304,2:2,16:16,Param(H36,H37,H38,""))
   </strong>
   but replace the data portal name with the name you created for your own example. Make sure the the cell with the ReportRange() formula is selected.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328598112.png" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-5_12-33-4.png" data-linked-resource-id="328598112" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="7498563a-8ae6-4eff-865b-08bb5885bd90" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328598112.png"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 3:
   </strong>
   Next, click
   <strong>
    Advanced Menu
   </strong>
   in the INTERJECT Ribbon.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-external-resource" data-image-src="https://interject.atlassian.net/wiki/download/attachments/83689479/2.02-Advanced%20Menu.png?version=1&amp;modificationDate=1499283884553&amp;cacheVersion=1&amp;api=v2" src="attachments/83689479/128892592.png"/>
   </span>
  </p>
  <p>
   This button is a toggle, so if it is currently showing
   <strong>
    Simple Menu
   </strong>
   the advanced menu is already showing.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-external-resource" data-image-src="https://interject.atlassian.net/wiki/download/attachments/83689479/Interject%20Ribbon%20Advanced%20Menu.png?version=3&amp;modificationDate=1496856142352&amp;cacheVersion=1&amp;api=v2" src="attachments/83689479/128336775.png"/>
   </span>
  </p>
  <p>
   <br/>
   <strong>
    Step 4:
   </strong>
   Click the
   <strong>
    System
   </strong>
   dropdown and select
   <strong>
    View SQL Test for ActiveCell
   </strong>
   . A window will pop up providing the developer with the SQL template used to create the stored procedure.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328565047.png" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-4_15-22-22.png" data-linked-resource-id="328565047" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="c560ec12-5fb2-4a37-9729-a3edccb34821" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328565047.png"/>
   </span>
  </p>
  <p>
   <strong>
    Step 5:
   </strong>
   Copy and paste the template code into the development environment, SQL Server Management Studio.
   <br/>
   The full text code is shown below.
  </p>
  <div class="code panel pdl" style="border-width: 1px;">
   <div class="codeHeader panelHeader pdl hide-border-bottom" style="border-bottom-width: 1px;">
    <b class=" code-title">
     Customer Invoices Test Script
    </b>
    <span class="collapse-source expand-control" style="display:none;">
     <span class="expand-control-icon icon">
     </span>
     <span class="expand-control-text">
      Expand source
     </span>
    </span>
    <span class="collapse-spinner-wrapper">
    </span>
   </div>
   <div class="codeContent panelContent pdl hide-toolbar">
    <pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: sql; gutter: true; first-line: 1; theme: Confluence; collapse: true" data-theme="Confluence">Execute [demo].[Northwind_Invoices_Pull_MyName]
	@CompanyName = 'market'
	,@ContactName = ''
	,@CustomerID = ''
	,@IncludePaid = ''
	,@Interject_RequestContext = '&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;
&lt;RequestContext&gt;
    &lt;ExcelVersion&gt;16.0&lt;/ExcelVersion&gt;
    &lt;IdsVersion&gt;2.3.0.11&lt;/IdsVersion&gt;
    &lt;FileName&gt;Interject_CustomerDemo_v1.xlsx&lt;/FileName&gt;
    &lt;FilePath&gt;C:\Users\MaryM\AppData\Local\Interject\FileCache&lt;/FilePath&gt;
    &lt;TabName&gt;CustomerAgingDetail&lt;/TabName&gt;
    &lt;CellRange&gt;H27&lt;/CellRange&gt;
    &lt;SourceFunction&gt;Ranges&lt;/SourceFunction&gt;
    &lt;UtcOffset&gt;-7&lt;/UtcOffset&gt;
    &lt;ColDefItems&gt;
        &lt;Value Row="2" Column="1"&gt;
            &lt;Name&gt;CustomerId&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="2"&gt;
            &lt;Name&gt;InvoiceID&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="9"&gt;
            &lt;Name&gt;InvoiceNum&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="10"&gt;
            &lt;Name&gt;OrderID&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="11"&gt;
            &lt;Name&gt;InvoiceDate&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="12"&gt;
            &lt;Name&gt;Current&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="13"&gt;
            &lt;Name&gt;30Days&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="14"&gt;
            &lt;Name&gt;60Days&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="15"&gt;
            &lt;Name&gt;90Days&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="18"&gt;
            &lt;Name&gt;ExpectedDate&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="20"&gt;
            &lt;Name&gt;Note&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="21"&gt;
            &lt;Name&gt;[Clear]&lt;/Name&gt;
        &lt;/Value&gt;
    &lt;/ColDefItems&gt;
    &lt;ResultDefItems /&gt;
    &lt;RowDefItems&gt;
        &lt;Value Row="46" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;BOTTM&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="53" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;BOTTM&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="60" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;BOTTM&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="67" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;BOTTM&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="74" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;GREAL&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="81" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;GREAL&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="88" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;GREAL&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="95" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;GREAL&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="102" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;SAVEA&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="109" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;SAVEA&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="116" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;SAVEA&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="123" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;SAVEA&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="130" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;WHITC&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="137" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;WHITC&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="144" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;WHITC&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="151" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;WHITC&lt;/Name&gt;
        &lt;/Value&gt;
    &lt;/RowDefItems&gt;
    &lt;UserContext&gt;
    &lt;MachineLoginName&gt;MaryM&lt;/MachineLoginName&gt;
    &lt;MachineName&gt;.&lt;/MachineName&gt;
    &lt;FullName&gt; &lt;/FullName&gt;
    &lt;UserId&gt;UUvP4HYoeu&lt;/UserId&gt;
    &lt;ClientId&gt;CgCfW9qi&lt;/ClientId&gt;
    &lt;LoginName&gt;MaryM@mycompany.com&lt;/LoginName&gt;
    &lt;LoginAuthTypeId&gt;10&lt;/LoginAuthTypeId&gt;
    &lt;LoginDateUtc&gt;05/03/2018 5:39:48&lt;/LoginDateUtc&gt;
    &lt;UserRoles&gt;
        &lt;Role&gt;ClientAdmin&lt;/Role&gt;
    &lt;/UserRoles&gt;
&lt;/UserContext&gt;
    &lt;UserContextEncrypted&gt;Encrypted only through interject api protocol, not direct connection&lt;/UserContextEncrypted&gt;
    &lt;XMLDataToSave&gt;&lt;/XMLDataToSave&gt;
&lt;/RequestContext&gt;'
</pre>
   </div>
  </div>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 7:
   </strong>
   When this code is executed, it returns the following result set.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328532284.png" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-4_14-52-7.png" data-linked-resource-id="328532284" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="426ed53f-81da-4ce3-bc43-342188183711" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328532284.png"/>
   </span>
  </p>
  <h3 id="L13.1Dev:CustomerAgingDetail-CreateReport">
   <span class="confluence-anchor-link" id="L13.1Dev:CustomerAgingDetail-CreateReport">
   </span>
  </h3>
  <h3 id="L13.1Dev:CustomerAgingDetail-CreateTheReport">
   Create The Report
  </h3>
  <p>
   At this point you, have a tested a new stored procedure that uses parameters to filter the results. You set up an INTERJECT data connection to go to your example database and you added another INTERJECT data portal to use that connection, which is mapped to the stored procedure that you just created. So now you are ready to build the spreadsheet report using two data portals.
  </p>
  <p>
   The steps for building the spreadsheet report are in the lab
   <a href="https://interject.atlassian.net/wiki/spaces/ID/pages/128429387/L3.4+Customer+Aging+Detail" rel="nofollow">
    Customer Aging Detail
   </a>
   .  You have likely completed this in earlier training sessions. Repeat the instructions with your newly created data portals discussed in this topic. When you are done, your report should resemble the screenshot below.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328597883.png" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-4_15-4-36.png" data-linked-resource-id="328597883" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="4d5ca7a7-4046-4030-9797-0295c20fa42f" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328597883.png"/>
   </span>
  </p>
  <h3 id="L13.1Dev:CustomerAgingDetail-NewDataPortal">
   <span class="confluence-anchor-link" id="L13.1Dev:CustomerAgingDetail-NewDataPortal">
   </span>
  </h3>
  <h3 id="L13.1Dev:CustomerAgingDetail-CreatingaNewDataPortalWithMultipleRecordsets">
   Creating a New Data Portal With Multiple Recordsets
  </h3>
  <p>
   You just created a report that used ReportRange() to list all the customers with subtotaled regions. Then ReportVariable() was used to populate the invoices for each customer region. Two separate data portals were used and two connections were made to the database.
  </p>
  <p>
   To illustrate the multiple recordset feature of INTERJECT, you can take this one step further. You can copy the second data portal and stored procedure and modify it so that it returns both recordsets. In this approach, you make only one connection to the database, which is more efficient. And this process requires one less data portal and stored procedure to create.
  </p>
  <p>
   Multiple recordsets are a very efficient report approach when your data is not a simple list.  In this example the feature will work as follows. On the first data request two recordsets are retrieved by INTERJECT. ReportRange() uses the customer summary list recordset but both recordsets temporarily remain in memory until all report formulas are completed. This allows the ReportVariable() to access the second recordset for populating the details in the same report run.  The following steps will help you create this change yourself.
  </p>
  <p>
   <strong>
    Step 1:
   </strong>
   Navigate to the data portal that you just created , similar to
   <strong>
    NorthwindCustomerInvoices_MyName
   </strong>
   , and click the green clone button on the top right of the page.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328532225.jpg" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="Step 1.jpg" data-linked-resource-id="328532225" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="4eef316c-ec70-42bd-b7b2-b7dbac4ae2a5" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328532225.jpg"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 2:
   </strong>
   A new data portal named,
   <strong>
    NorthwindCustomerInvoices_MyName_copy
   </strong>
   , generates. Change this data portal name to
   <strong>
    NorthwindMultiRecord_MyName
   </strong>
   . You can add your name to the suffix, because each data portal code must be unique.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328335666.jpg" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="Step 2.jpg" data-linked-resource-id="328335666" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="eba76ee8-23a4-40ab-9a8b-0ed15de739bd" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328335666.jpg"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 3:
   </strong>
   Change the procedure name to run
   <strong>
    [demo].[Northwind_CustomerInvoices_Pull_MyName]
   </strong>
   but use your own name as the suffice.  You will create this stored procedure shortly. Everything else in the cloned data portal remains the same.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328597786.jpg" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="Step 3.jpg" data-linked-resource-id="328597786" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="cce391f5-7744-49c9-a983-3e9260734fb3" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328597786.jpg"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <h3 id="L13.1Dev:CustomerAgingDetail-UpdatingSP">
   <span class="confluence-anchor-link" id="L13.1Dev:CustomerAgingDetail-UpdatingSP">
   </span>
  </h3>
  <h3 id="L13.1Dev:CustomerAgingDetail-UpdatingtheStoredProcedurefor2Recordsets.1">
   Updating the Stored Procedure for 2 Recordsets
  </h3>
  <p>
   <strong>
    Step 1:
   </strong>
   In SQL Server Management Studio, open the stored procedure used in the report that pulled the invoice detail.  The stored procedure name should be similar to [demo].[Northwind_Invoices_Pull_MyName].
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328597796.png" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-4_14-9-44.png" data-linked-resource-id="328597796" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="53dbb304-e97d-43bb-ab7c-1747b0b6cb9c" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328597796.png"/>
   </span>
  </p>
  <p>
   <strong>
    Step 2:
   </strong>
   Change the name of the stored procedure to [demo].[Northwind_CustomerInvoices_MyName], using your own name as the suffix.  By using ‘Create procedure’ as shown below, the stored procedure will be copied to the new name when executed.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328597801.png" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-4_14-15-28.png" data-linked-resource-id="328597801" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="edcdc917-1dee-4997-9d93-655e123a4907" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328597801.png"/>
   </span>
  </p>
  <p>
   <strong>
    Step 3:
   </strong>
   Change the
   <strong>
    Create procedure
   </strong>
   back to
   <strong>
    Alter procedure
   </strong>
   and continue with editing the new procedure.
  </p>
  <p>
   <strong>
    Step 4:
   </strong>
   You have to make a few changes to the stored procedure so the summary record set showing a list of customers can be provided.  First add
   <strong>
    into #InvoiceDetail
   </strong>
   as shown below. It will put the invoice detail in a temporary table to be used later in the stored procedure.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328335685.png" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-4_14-17-54.png" data-linked-resource-id="328335685" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="23aef079-bb62-4574-8421-14d839866bb2" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328335685.png"/>
   </span>
  </p>
  <p>
   <strong>
    Step 5:
   </strong>
   After the SQL statement, add
   <strong>
    Select * from #InvoiceDetail
   </strong>
   . Then order by the CustomerID. This step returns the invoice detail as the first recordset from the stored procedure.
  </p>
  <p>
   <strong>
    Step 6:
   </strong>
   Next you must use the detail to generate a customer summary list.  The below code should be copied into the bottom of the stored procedure.  This code simply creates a distinct list of all the customers include in the invoice detail and orders by the customer name.
  </p>
  <p>
   Steps 5 and 6 should look like below:
  </p>
  <div class="code panel pdl" style="border-width: 1px;">
   <div class="codeHeader panelHeader pdl hide-border-bottom" style="border-bottom-width: 1px;">
    <b class=" code-title">
     Summary From Detail
    </b>
    <span class="collapse-source expand-control" style="display:none;">
     <span class="expand-control-icon icon">
     </span>
     <span class="expand-control-text">
      Expand source
     </span>
    </span>
    <span class="collapse-spinner-wrapper">
    </span>
   </div>
   <div class="codeContent panelContent pdl hide-toolbar">
    <pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: sql; gutter: true; first-line: 152; theme: Confluence; collapse: true" data-theme="Confluence">-- Select all detail from the dataset created above
SELECT * FROM #InvoiceDetail
ORDER BY [CustomerID]

-- Select unique customers to form a summary list of all of the customers.
SELECT DISTINCT 
	 [CustomerID]
	,[CompanyName]
	,[ContactName]
	,[ContactTitle]
	,[Country] 
FROM #InvoiceDetail
ORDER BY CustomerID</pre>
   </div>
  </div>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 7:
   </strong>
   The changes to the stored procedure are complet.  It is important to test the stored procedure in the database before testing it through the INTERJECT platform. You can use the same test script used earlier in this topic.  Your test code should look similar to the SQL below.
  </p>
  <div class="code panel pdl" style="border-width: 1px;">
   <div class="codeHeader panelHeader pdl hide-border-bottom" style="border-bottom-width: 1px;">
    <b class=" code-title">
     MultiRecord Test Script
    </b>
    <span class="collapse-source expand-control" style="display:none;">
     <span class="expand-control-icon icon">
     </span>
     <span class="expand-control-text">
      Expand source
     </span>
    </span>
    <span class="collapse-spinner-wrapper">
    </span>
   </div>
   <div class="codeContent panelContent pdl hide-toolbar">
    <pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: sql; gutter: true; first-line: 1; theme: Confluence; collapse: true" data-theme="Confluence">Execute [demo].[Northwind_CustomerInvoices_Pull_MyName]
	@CompanyName = 'market'
	,@ContactName = ''
	,@CustomerID = ''
	,@IncludePaid = ''
	,@Interject_RequestContext = '&lt;?xml version="1.0" encoding="utf-16" standalone="yes"?&gt;
&lt;RequestContext&gt;
    &lt;ExcelVersion&gt;16.0&lt;/ExcelVersion&gt;
    &lt;IdsVersion&gt;2.3.0.11&lt;/IdsVersion&gt;
    &lt;FileName&gt;Interject_CustomerDemo_v1.xlsx&lt;/FileName&gt;
    &lt;FilePath&gt;C:\Users\Marym\AppData\Local\Interject\FileCache&lt;/FilePath&gt;
    &lt;TabName&gt;CustomerAgingDetail&lt;/TabName&gt;
    &lt;CellRange&gt;H27&lt;/CellRange&gt;
    &lt;SourceFunction&gt;Ranges&lt;/SourceFunction&gt;
    &lt;UtcOffset&gt;-7&lt;/UtcOffset&gt;
    &lt;ColDefItems&gt;
        &lt;Value Row="2" Column="1"&gt;
            &lt;Name&gt;CustomerId&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="2"&gt;
            &lt;Name&gt;InvoiceID&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="9"&gt;
            &lt;Name&gt;InvoiceNum&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="10"&gt;
            &lt;Name&gt;OrderID&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="11"&gt;
            &lt;Name&gt;InvoiceDate&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="12"&gt;
            &lt;Name&gt;Current&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="13"&gt;
            &lt;Name&gt;30Days&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="14"&gt;
            &lt;Name&gt;60Days&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="15"&gt;
            &lt;Name&gt;90Days&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="18"&gt;
            &lt;Name&gt;ExpectedDate&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="20"&gt;
            &lt;Name&gt;Note&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="2" Column="21"&gt;
            &lt;Name&gt;[Clear]&lt;/Name&gt;
        &lt;/Value&gt;
    &lt;/ColDefItems&gt;
    &lt;ResultDefItems /&gt;
    &lt;RowDefItems&gt;
        &lt;Value Row="46" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;BOTTM&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="61" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;BOTTM&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="76" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;BOTTM&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="91" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;BOTTM&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="106" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;GREAL&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="117" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;GREAL&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="128" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;GREAL&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="139" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;GREAL&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="150" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;SAVEA&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="173" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;SAVEA&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="196" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;SAVEA&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="219" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;SAVEA&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="242" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;WHITC&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="258" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;WHITC&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="274" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;WHITC&lt;/Name&gt;
        &lt;/Value&gt;
        &lt;Value Row="290" Column="1" ColumnName="CustomerId"&gt;
            &lt;Name&gt;WHITC&lt;/Name&gt;
        &lt;/Value&gt;
    &lt;/RowDefItems&gt;
    &lt;UserContext&gt;
    &lt;MachineLoginName&gt;MaryM&lt;/MachineLoginName&gt;
    &lt;MachineName&gt;.&lt;/MachineName&gt;
    &lt;FullName&gt; &lt;/FullName&gt;
    &lt;UserId&gt;UUvP4HYoeu&lt;/UserId&gt;
    &lt;ClientId&gt;CgCfW9qi&lt;/ClientId&gt;
    &lt;LoginName&gt;Mary@mycompany.com&lt;/LoginName&gt;
    &lt;LoginAuthTypeId&gt;10&lt;/LoginAuthTypeId&gt;
    &lt;LoginDateUtc&gt;05/03/2018 5:39:48&lt;/LoginDateUtc&gt;
    &lt;UserRoles&gt;
        &lt;Role&gt;ClientAdmin&lt;/Role&gt;
    &lt;/UserRoles&gt;
&lt;/UserContext&gt;
    &lt;UserContextEncrypted&gt;Encrypted only through interject api protocol, not direct connection&lt;/UserContextEncrypted&gt;
    &lt;XMLDataToSave&gt;&lt;/XMLDataToSave&gt;
&lt;/RequestContext&gt;'</pre>
   </div>
  </div>
  <p>
   <br/>
  </p>
  <p>
   When this code is executed, it should return two recordsets as shown below.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328532260.png" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-4_14-5-29.png" data-linked-resource-id="328532260" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="aedec8eb-ce62-49e8-af50-8a16eeab466d" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328532260.png"/>
   </span>
  </p>
  <h3 id="L13.1Dev:CustomerAgingDetail-UpdateReport">
   <span class="confluence-anchor-link" id="L13.1Dev:CustomerAgingDetail-UpdateReport">
   </span>
  </h3>
  <h3 id="L13.1Dev:CustomerAgingDetail-UpdatingtheReportfor2Recordsets.1">
   Updating the Report for 2 Recordsets
  </h3>
  <p>
   You are ready to modify the report to use your new data portal.  The changes are simple since you only need to use a new function, jDataPortal(), to specify the data portal recordset number for each report function.
  </p>
  <p>
   <strong>
    Step 1:
   </strong>
   In the
   <strong>
    Customer Aging Detail
   </strong>
   report that you just completed, change the
   <strong>
    =ReportRange()
   </strong>
   function by replacing the previous data portal with the new one.  However, you will be encasing the new data portal inside a jDataPortal() function. So
   <strong>
    =ReportRange(“oldDataPortalCode”,..
   </strong>
   becomes
   <strong>
    =ReportRange(jDataPortal(“NorthwindMultiRecord_MyName”,2),...
   </strong>
   The end result should look like the below screenshot for ReportRange().
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328401287.png" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-5_10-9-35.png" data-linked-resource-id="328401287" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="a5ef514b-3029-47da-b5e8-52431ace4087" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328401287.png"/>
   </span>
  </p>
  <p>
   The second parameter, DataResultNumber, indicates which recordset this report function will use.  Using
   <strong>
    2
   </strong>
   causes the ReportRange() function to grab the second recordset that is a simple list of customers.
  </p>
  <p>
   <strong>
    Step 4:
   </strong>
   Now change the
   <strong>
    =ReportVariable()
   </strong>
   function by replacing the previous data portal with the new one.  Again you must encase the new data portal inside a jDataPortal() function. So
   <strong>
    =ReportVariable(“oldDataPortalCode”,..
   </strong>
   becomes
   <strong>
    =ReportVariable(jDataPortal(“NorthwindMultiRecord_MyName”,1),...
   </strong>
   In this step you are using
   <strong>
    1
   </strong>
   so the first record set is used in this report function. The end result should look like the below screenshot for ReportVariable().
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328401292.png" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-5_10-13-57.png" data-linked-resource-id="328401292" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="6add4ab5-b0a9-49a2-84aa-a4f476288a54" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328401292.png"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 5:
   </strong>
   Once the report formulas are edited, you can re-pull the data in the report and the results should be the same as when it used two data portals.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324435969/328532252.png" data-linked-resource-container-id="324435969" data-linked-resource-container-version="43" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-4_14-4-54.png" data-linked-resource-id="328532252" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="de33b098-c0c1-4096-a19e-fd53b4469c17" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324435969/328532252.png"/>
   </span>
  </p>
 </div>
</div>