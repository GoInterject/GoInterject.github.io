---
title: Interject Documentation > L12.1 Dev> Customer Aging
layout: custom
---
<div class="wiki-content group" id="main-content">
 <hr/>
 <div id="#main-content">
  <h2 id="L12.1Dev:CustomerAging-Top">
   <strong>
    <span class="confluence-anchor-link" id="L12.1Dev:CustomerAging-Top">
    </span>
   </strong>
  </h2>
  <h2 id="L12.1Dev:CustomerAging-Overview">
   <strong>
    Overview
   </strong>
  </h2>
  <p>
   <span>
    On this page, you will create a simple data pull using the Customer Aging Report. To review the business use case for this report, see
   </span>
   <span>
    <a href="/wAbout/Customer-Aging_128091294.html" rel="nofollow">
     <strong>
      Real World Walkthroughs
     </strong>
     <strong>
      - Customer Aging
     </strong>
    </a>
    .
   </span>
   <span>
    This lab begins with steps for creating the INTERJECT data connection and data portals, followed by the steps on how to create the stored procedure. Finally, you will be directed to another page that shows how to use the data portal to create the spreadsheet report from scratch.
   </span>
  </p>
  <p>
   <span>
    Go directly to any topic of this walk-through by clicking one of the links below:
   </span>
  </p>
  <ul>
   <li>
    <strong>
     <a href="#L12.1Dev:CustomerAging-SettingUpConxn">
      Setting up the Data Connection
     </a>
    </strong>
   </li>
   <li>
    <strong>
     <a href="#L12.1Dev:CustomerAging-SettingUpPo">
      Setting up the Data Portal
     </a>
    </strong>
   </li>
   <li>
    <strong>
     <a href="#L12.1Dev:CustomerAging-SettingUpFormParam">
      Setting up the Formula Parameters
     </a>
    </strong>
   </li>
   <li>
    <strong>
     <a href="#L12.1Dev:CustomerAging-SystemParams">
      Setting up the System Parameters
     </a>
    </strong>
   </li>
   <li>
    <strong>
     <a href="#L12.1Dev:CustomerAging-CreateSP">
      Creating the Stored Procedure
     </a>
    </strong>
   </li>
   <li>
    <strong>
     <a href="#L12.1Dev:CustomerAging-CreateReport">
      Creating the Report
     </a>
    </strong>
   </li>
  </ul>
  <h3 id="L12.1Dev:CustomerAging-SettingUpConxn">
   <span class="confluence-anchor-link" id="L12.1Dev:CustomerAging-SettingUpConxn">
   </span>
  </h3>
  <h3 id="L12.1Dev:CustomerAging-SettingUpTheDataConnection">
   Setting Up The Data Connection
  </h3>
  <p>
   <strong>
    Step 1:
   </strong>
   <span>
    Navigate to
    <a class="external-link" href="https://portal.gointerject.com" rel="nofollow">
     https://portal.gointerject.com
    </a>
    and log in. Set up a data connection by clicking the
    <strong>
     Data Connections
    </strong>
    icon.
   </span>
  </p>
  <p>
   <span>
    <span class="confluence-embedded-file-wrapper">
     <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/327909418.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="Login.jpg" data-linked-resource-id="327909418" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="cc7fa413-6cce-43fc-a3a5-9d42a3d0fb86" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/327909418.jpg"/>
    </span>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 2:
   </strong>
   <span>
    On the Data Connections page, click the
    <strong>
     New Connection
    </strong>
    button.
   </span>
  </p>
  <p>
   <span>
    <span class="confluence-embedded-file-wrapper">
     <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/327909423.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="NewConnection1.jpg" data-linked-resource-id="327909423" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="6bed4b24-906d-4ba3-9b4a-24c70c40eb43" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/327909423.jpg"/>
    </span>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 3:
   </strong>
   <span>
    In the Connection Type field, verify that
    <strong>
     Database
    </strong>
    is selected.
   </span>
  </p>
  <p>
   <span>
    <span class="confluence-embedded-file-wrapper">
     <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/327843971.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="VerifyConnectionType.jpg" data-linked-resource-id="327843971" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="cccce3c5-0f25-4801-bb74-c21198deb4da" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/327843971.jpg"/>
    </span>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 4:
   </strong>
   <span>
    The Connection Details page needs to contain the following information for the new connection. Type
    <strong>
     NorthwindExampleDB_MyName
    </strong>
    in Connection Name, but include your own name in the suffix. Each connection name must be unique. Â For the connection string, type
    <strong>
     Server=myServerAddress;Database=myDataBase;Trusted_Connection=True;
    </strong>
    . You are using Windows authentication, so username and password are not required. Replace the server name and database name to match your own that you are using for this walk-through.
   </span>
  </p>
  <p>
   <span>
    <span class="confluence-embedded-file-wrapper">
     <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/327876691.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="SettingUpConnection.jpg" data-linked-resource-id="327876691" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="4d1e223b-a103-452b-92fc-108c4591b87d" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/327876691.jpg"/>
    </span>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 5:
   </strong>
   In the Description field include details about what the data connection will be used for.
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/328007797.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="DescriptionDataConnection.jpg" data-linked-resource-id="328007797" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="21611ae2-f6fa-4ac3-bb63-b265f385e73d" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/328007797.jpg"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 6:
   </strong>
   <span>
    Click the Save button to create the new data connection.
   </span>
  </p>
  <p>
   <span>
    <span class="confluence-embedded-file-wrapper">
     <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/327811109.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="SaveSuccessDataConnection.jpg" data-linked-resource-id="327811109" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="226e6c0e-fc7e-4f84-b435-8af1d99f1edd" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/327811109.jpg"/>
    </span>
   </span>
  </p>
  <p>
   <span>
    The Database Data Connection is now ready to be used in a Data Portal. You should always test a new connection with your security context. Follow the steps in
    <a href="/wPortal/Data-Connections_324403237.html" rel="nofollow">
     Data Connections
    </a>
    to test your connection string.
   </span>
  </p>
  <h3 id="L12.1Dev:CustomerAging-SettingUpPortal">
   <span class="confluence-anchor-link" id="L12.1Dev:CustomerAging-SettingUpPortal">
   </span>
  </h3>
  <h3 id="L12.1Dev:CustomerAging-SettingUpTheDataPortal">
   Setting Up The Data Portal
  </h3>
  <p>
   <strong>
    Step 1:
   </strong>
   <span>
    To add a new data portal, return to
   </span>
   <a class="external-link" href="https://portal.gointerject.com" rel="nofollow">
    <span>
     https://portal.gointerject.com
    </span>
   </a>
   <span>
    and select Data Portals from the sidebar menu.
   </span>
  </p>
  <p>
   <span>
    <span class="confluence-embedded-file-wrapper confluence-embedded-manual-size">
     <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/328007792.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="DataportalLogin.jpg" data-linked-resource-id="328007792" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="763a8cd8-9f0f-4fae-9d2a-ad094e4d5a66" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/328007792.jpg?width=720" width="720"/>
    </span>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step
   </strong>
   <strong>
    2:
   </strong>
   Select New Data Portal
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/328106031.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="NewDataPortal1.jpg" data-linked-resource-id="328106031" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="ba8b4ae2-f326-4afe-a615-9040b94853e7" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/328106031.jpg"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 3:
   </strong>
   <span>
    Type
    <strong>
     NorthwindCustomers_MyName
    </strong>
    for the Data Portal Code. Â Since this field must be unique, add your name to the suffix. Select the connection that was made in the previous step,
    <strong>
     NorthwindExampleDB_MyName
    </strong>
    . Â Also enter a name for the stored procedure
    <strong>
     [demo].[Northwind_Customers_Pull_MyName]
    </strong>
    , which will be created later.
   </span>
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/328270171.png" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-5_11-20-9.png" data-linked-resource-id="328270171" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="9bb97483-343d-4c3a-ae4a-9a011ce233fd" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/328270171.png"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 4
   </strong>
   <span>
    : Click
    <strong>
     Create Data Portal
    </strong>
    to save the new data portal. Additional options display after selecting the Create Data Portal button for adding parameters.
   </span>
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/328598107.png" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-5_11-22-58.png" data-linked-resource-id="328598107" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="e07726dc-8e68-48b6-a19d-05196fe9a4f7" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/328598107.png"/>
   </span>
  </p>
  <p>
   <span>
    <strong>
     Note:
    </strong>
    If this is your first time setting up a data portal, review
    <strong>
     Data Portals
    </strong>
    , which describes the data portal parameters in more detail, including the difference between formula and system parameters. Return to the next step to continue.
   </span>
  </p>
  <p style="margin-left: 690.0px;">
   <a href="#L12.1Dev:CustomerAging-Top">
    Back to Top
   </a>
  </p>
  <h3 id="L12.1Dev:CustomerAging-SettingUpFormParam">
   <span class="confluence-anchor-link" id="L12.1Dev:CustomerAging-SettingUpFormParam">
   </span>
  </h3>
  <h3 id="L12.1Dev:CustomerAging-SettingUpFormulaParameters">
   Setting Up Formula Parameters
  </h3>
  <p>
   <strong>
    Step 1:
   </strong>
   <span>
    To add your first formula parameter, click
    <strong>
     Click here to add a Formula Parameter
    </strong>
    . For this parameter, enter
    <strong>
     CompanyName
    </strong>
    for Name,
    <strong>
     varchar
    </strong>
    for Type, and
    <strong>
     input
    </strong>
    for Direction to input, as shown below.
   </span>
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/328007802.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="FormulaParam1.jpg" data-linked-resource-id="328007802" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="82979005-1530-4281-828d-c84b67505178" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/328007802.jpg"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 2:
   </strong>
   <span>
    Click the
    <strong>
     More
    </strong>
    button.
   </span>
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/327811099.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="ClickMore.jpg" data-linked-resource-id="327811099" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="f787e3e2-f218-4be7-ad02-1943ac59ecdc" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/327811099.jpg"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <span>
    <strong>
     Step 3:
    </strong>
    As shown in the screenshot below, enter
    <strong>
     Market
    </strong>
    for Helper Default and
    <strong>
     Search is a wildcard that contains search
    </strong>
    for Comments.
   </span>
   <span>
    Click the Save icon.
   </span>
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/327843961.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="AdditionalInfoFormParamsnag.jpg" data-linked-resource-id="327843961" data-linked-resource-type="attachment" data-linked-resource-version="2" data-media-id="3023ffce-10a2-4faf-aa4a-ebd117e62dc8" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/327843961.jpg"/>
   </span>
  </p>
  <p>
   <span>
    <strong>
     Note:
    </strong>
    When you set up a formula parameter, the Save icon is red until you save your changes. After your changes are saved, the Save icon turns green.
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 5:
   </strong>
   <span>
    Click the
   </span>
   <span>
    <strong>
     Click here to add a Formula Parameter
    </strong>
   </span>
   <span>
    to add the second parameter. Enter
    <strong>
     ContactName
    </strong>
    for Name,
    <strong>
     varchar
    </strong>
    for Type, and
    <strong>
     input
    </strong>
    for Direction.
   </span>
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/327811104.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="FormulaParam4.jpg" data-linked-resource-id="327811104" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="eba18c45-add2-4f1c-8ab2-cec9d14f7140" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/327811104.jpg"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <span>
    <strong>
     Step 6:
    </strong>
    Click the
    <strong>
     More
    </strong>
    button
   </span>
  </p>
  <p>
   <span>
    <span class="confluence-embedded-file-wrapper">
     <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/327942188.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="FormulaParam4ClickMore.jpg" data-linked-resource-id="327942188" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="835092e6-abc5-4d7e-91a1-2e27979dfb1d" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/327942188.jpg"/>
    </span>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <span>
    Enter
    <strong>
     Contact Name
    </strong>
    for Helper Name and
    <strong>
     Search is a wildcard that contains search
    </strong>
    for Comments. Click the Save icon.
   </span>
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/328138883.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="FormulaParam4AdditionalInfo.jpg" data-linked-resource-id="328138883" data-linked-resource-type="attachment" data-linked-resource-version="2" data-media-id="16b493ed-917c-4c28-9638-937fdea65e10" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/328138883.jpg"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 7:
   </strong>
   <span>
    To add the final Formula Parameter click
   </span>
   <span>
    <strong>
     Click here to add a Formula Parameter
    </strong>
   </span>
   <span>
    . Enter
    <strong>
     CustomerID
    </strong>
    for Name,
    <strong>
     varchar
    </strong>
    for Type, and
    <strong>
     input
    </strong>
    for Direction.
   </span>
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/328171537.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="FormulaParam5.jpg" data-linked-resource-id="328171537" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="30565257-edb0-4f0b-ac74-0caf6dd4446c" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/328171537.jpg"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <span>
    <strong>
     Step 8:
    </strong>
    Click the
    <strong>
     More
    </strong>
    button
   </span>
  </p>
  <p>
   <span>
    <span class="confluence-embedded-file-wrapper">
     <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/327876686.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="FormulaParam5ClickMore.jpg" data-linked-resource-id="327876686" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="dede5edc-d48b-4333-bdd0-d2dabe6bb9bb" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/327876686.jpg"/>
    </span>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <span>
    Enter
    <strong>
     Customer ID
    </strong>
    for Helper Name and
    <strong>
     The customer ID is an exact search that will be used by the drill
    </strong>
    for Comments. Click the Save icon.
   </span>
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/328138888.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="FormulaParam5AdditionalInfo.jpg" data-linked-resource-id="328138888" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="e4755514-8610-4a39-a68f-0b8a48abcdcc" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/328138888.jpg"/>
   </span>
  </p>
  <p style="margin-left: 660.0px;">
   <a href="#L12.1Dev:CustomerAging-Top">
    Back to Top
   </a>
  </p>
  <h3 id="L12.1Dev:CustomerAging-SystemParams">
   <span class="confluence-anchor-link" id="L12.1Dev:CustomerAging-SystemParams">
   </span>
  </h3>
  <h3 id="L12.1Dev:CustomerAging-SystemParameters">
   System Parameters
  </h3>
  <p>
   <span>
    System parameters are similar to formula parameters, except the system parameter values are provided by the system instead of cells that are in the spreadsheet report. There are several system parameters that aid in communication with the middle-tier service. In this case, a stored procedure is used. See
    <strong>
     Data Portals
    </strong>
    in
    <strong>
     Interject Website Portal
    </strong>
    for more information.
   </span>
  </p>
  <p>
   <span>
    In this example, you will use the system parameter,
    <strong>
     Interject_NTLogin
    </strong>
    , which passes the userâs Windows login. This is helpful for implementing row-level security; however, the best practice is to use SQL Server built-in functions like sysname() when available. You are also using
    <strong>
     Interject_LocalTimeZoneOffset
    </strong>
    , which provides the numeric offset in hours between the userâs profile time zone setting and universal time. The
    <strong>
     Interject_LocalTimeZoneOffset
    </strong>
    parameter is used to convert date and time values to the userâs time zone.
   </span>
  </p>
  <p>
   <strong>
    Step 1:
   </strong>
   <span>
    To add a new system parameter, click
    <strong>
     Click here to add a System Parameter
    </strong>
    button. Choose
    <strong>
     Interject_NTLogin
    </strong>
    for the name of the first parameter. Click
    <strong>
     Save
    </strong>
    .
   </span>
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/327811114.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="SystemParameters1.jpg" data-linked-resource-id="327811114" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="68b13046-fc9d-457f-b340-6edac826adc9" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/327811114.jpg"/>
   </span>
  </p>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 2:
   </strong>
   <span>
    Add a second system parameter by clicking
    <strong>
     Add a System Parameter
    </strong>
    button. Choose
    <strong>
     Interject_LocalTimeZoneOffset
    </strong>
    for the name and click Save.
   </span>
  </p>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/327843966.jpg" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/jpeg" data-linked-resource-default-alias="SystemParameters2.jpg" data-linked-resource-id="327843966" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="bfd78849-135e-4ba9-89b4-c655c5e1d113" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/327843966.jpg"/>
   </span>
  </p>
  <p style="margin-left: 660.0px;">
   <a href="#L12.1Dev:CustomerAging-Top">
    Back to Top
   </a>
  </p>
  <h3 id="L12.1Dev:CustomerAging-CreateSP">
   <span class="confluence-anchor-link" id="L12.1Dev:CustomerAging-CreateSP">
   </span>
  </h3>
  <h3 id="L12.1Dev:CustomerAging-CreatingtheStoredProcedure">
   Creating the Stored Procedure
  </h3>
  <p>
   <span>
    A stored procedure or data API servers as a middle tier for an INTERJECT report. In t
   </span>
   <span>
    his example you will be using a stored procedure. Â INTERJECT can retrieve one more result sets from the stored procedure into the spreadsheet report.
   </span>
  </p>
  <p>
   <span>
    The INTERJECT Website Portal allows you to create and manage Data Portals and reference stored procedures you create. Â Data Portals are stored locally in your Excel session when you log into INTERJECT. When requesting data INTERJECT creates a point-to-point connection with the intended data source.
   </span>
  </p>
  <p>
   <span>
    The below steps assume you are proficient with SQL Management Studio for Microsoft SQL Server and in creating stored procedures. Â If you need additional training in this area, please contact us at
    <a class="external-link" href="mailto:info@gointerject.com" rel="nofollow">
     info@gointerject.com
    </a>
    .
   </span>
  </p>
  <p>
   <strong>
    Step 1:
   </strong>
   <span>
    Create a stored procedure called [demo].[Northwind_Customers_Pull_MyName] using the following code example.
   </span>
  </p>
  <div class="code panel pdl" style="border-width: 1px;">
   <div class="codeHeader panelHeader pdl hide-border-bottom" style="border-bottom-width: 1px;">
    <b class=" code-title">
     Customer Aging
    </b>
    <span class="collapse-source expand-control" style="display:none;">
     <span class="expand-control-icon icon">
     </span>
     <span class="expand-control-text">
      Expand source
     </span>
    </span>
    <span class="collapse-spinner-wrapper">
    </span>
   </div>
   <div class="codeContent panelContent pdl hide-toolbar">
    <pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: sql; gutter: true; first-line: 1; theme: Confluence; collapse: true" data-theme="Confluence">CREATE PROC [demo].[Northwind_Customers_Pull_MyName]

	 @CompanyName					VARCHAR(100)
	,@ContactName					VARCHAR(100)
	,@CustomerID					VARCHAR(500) = ''
	,@Interject_NTLogin				VARCHAR(50) 
	,@Interject_LocalTimeZoneOffset MONEY

AS
BEGIN

SET NOCOUNT ON  -- helps reduce conflicts with ADO

DECLARE @DateCompare VARCHAR(20) = '1997-09-15'
DECLARE @ErrorMessage VARCHAR(100)

IF LEN(@CompanyName)&gt;40
BEGIN
	SET @ErrorMessage = 'Usernotice:The company search text must not be more than 40 characters.'
	RAISERROR (@ErrorMessage, 18, 1)
	RETURN		
END

--CREATE CTE to consolidate the invoice data into seperate categories based on date
;WITH Invoice_CTE
AS
(
    SELECT 
		 CustomerID
		,SUM(InvoiceTotal)	AS InvoiceTotal
		,SUM([Current])		AS [Current]
		,SUM([30Days])		AS [30Days]
		,SUM([60Days])		AS [60Days]
		,SUM([90Days])		AS [90Days]
		,IsPaid
	FROM 
	(
	SELECT 
		 i.CustomerID
		,i.InvoiceDate
		,i.InvoiceTotal
		,CASE WHEN DATEDIFF(dd,i.InvoiceDate,@DateCompare) &lt; 30	THEN (i.InvoiceTotal) ELSE 0 END AS [Current]
		,CASE WHEN DATEDIFF(dd,i.InvoiceDate,@DateCompare) between 30 and 59 THEN (i.InvoiceTotal) ELSE 0 END AS [30Days]
		,CASE WHEN DATEDIFF(dd,i.InvoiceDate,@DateCompare) between 60 and 89 THEN (i.InvoiceTotal) ELSE 0 END AS [60Days]
		,CASE WHEN DATEDIFF(dd,i.InvoiceDate,@DateCompare) &gt; 90	THEN (i.InvoiceTotal) ELSE 0 END AS [90Days]
		,IsPaid
    FROM [demo].[Northwind_Invoices] i
	WHERE IsPaid = 0 --This line selects the invoices that have not been paid 
	) t
	GROUP BY CustomerID, IsPaid
)

SELECT 
	 c.[CustomerID]
	,c.[CompanyName]
	,c.[ContactName]
	,c.[ContactTitle]
	,ISNULL(c.[Address],'') AS [Address]
	,c.[City]
	,c.[Region]
	,c.[PostalCode]
	,c.[Country]
	,c.[Phone]
	,cte.[Current]
	,cte.[30Days]
	,cte.[60Days]
	,cte.[90Days]
	,cte.IsPaid
	,ISNULL(c.PostalCode,'') + ',' + ISNULL(c.Country,'') AS TestValueList
FROM [demo].[Northwind_Customers] c
	LEFT JOIN Invoice_CTE cte
		ON c.CustomerID = cte.CustomerID
WHERE 
	(@CompanyName='' OR c.CompanyName LIKE '%' + @CompanyName + '%')
	AND
	(@ContactName='' OR c.ContactName LIKE '%' + @ContactName + '%')
	AND
	(@CustomerID='' OR c.CustomerID = @CustomerID)
ORDER BY c.[CompanyName] 
 
END</pre>
   </div>
  </div>
  <p>
   <br/>
  </p>
  <p>
   <strong>
    Step 2:
   </strong>
   <span>
    Stored procedure are natively supported by INTERJECT. Â There are a few key areas to note in the code example that help illustrate INTERJECT features.
   </span>
  </p>
  <ul>
   <li>
    <span>
     Parameters: The parameters included in the stored procedure are the same added to the Data Portal in a previous step. Â On each request, INTERJECT passes the Formula Parameters values from the spreadsheet configuration along with System Parameters to the stored procedure. Â Output parameters are supported which can populate values in the spreadsheet but they are not included in this example.
    </span>
   </li>
  </ul>
  <p>
   <span>
    <span class="confluence-embedded-file-wrapper">
     <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/328400910.png" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-3_18-16-38.png" data-linked-resource-id="328400910" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="dfe26664-0980-4b0b-9c80-5f60b9eb5ac3" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/328400910.png"/>
    </span>
   </span>
  </p>
  <ul>
   <li>
    <span>
     Validation: The example code includes an example of validating the input from Formula Parameter
     <strong>
      @CustomerName
     </strong>
     . Â It limits the search text to 40 characters and will raise an error if the length is beyond. The custom error shown has a prefix
     <strong>
      UserNotice:
     </strong>
     which tells INTERJECT to provide a message box with the text to the user as a response. Â Without the prefix, INTERJECT will interpret the error as a generic error.
    </span>
   </li>
  </ul>
  <p>
   <span class="confluence-embedded-file-wrapper">
    <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/328532005.png" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-3_18-15-33.png" data-linked-resource-id="328532005" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="96a0c6fd-d985-4900-9742-6f32a3ad6417" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/328532005.png"/>
   </span>
  </p>
  <ul>
   <li>
    <span>
     Select statements: Returning data to INTERJECT simply uses a select statement as shown below. More than one can be returned at a time to reduce the connections needed to fully populate a complex report. You only have one select statement in this example.
    </span>
   </li>
  </ul>
  <p>
   <span>
    <span class="confluence-embedded-file-wrapper">
     <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/328138934.png" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-3_13-18-9.png" data-linked-resource-id="328138934" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="2d1a8082-5d1d-49ee-a7b5-066dfeb7da4d" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/328138934.png"/>
    </span>
   </span>
  </p>
  <p>
   <strong>
    Step 3:
   </strong>
   <span>
    It is important to test the stored procedure in the database before testing through the INTERJECT platform. Â The example code included a test SQL statement that can be executed in a new query as shown below. Be sure to change the procedure name to match your own.
   </span>
  </p>
  <div class="code panel pdl" style="border-width: 1px;">
   <div class="codeHeader panelHeader pdl hide-border-bottom" style="border-bottom-width: 1px;">
    <b class=" code-title">
     Customer Aging Test Script
    </b>
    <span class="collapse-source expand-control" style="display:none;">
     <span class="expand-control-icon icon">
     </span>
     <span class="expand-control-text">
      Expand source
     </span>
    </span>
    <span class="collapse-spinner-wrapper">
    </span>
   </div>
   <div class="codeContent panelContent pdl hide-toolbar">
    <pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: sql; gutter: true; first-line: 1; theme: Confluence; collapse: true" data-theme="Confluence">Execute demo.[Northwind_Customers_Pull_MyName]
	@CompanyName = 'market'
	,@ContactName = ''
	,@CustomerID = ''
	,@Interject_NTLogin = 'MaryM'
	,@Interject_LocalTimeZoneOffset = -7
</pre>
   </div>
  </div>
  <p>
   <span>
    When executed you should see the following result set.
   </span>
  </p>
  <p>
   <span>
    <span class="confluence-embedded-file-wrapper">
     <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/328171553.png" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-3_12-46-59.png" data-linked-resource-id="328171553" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="acccfc88-a96a-4ecd-a6cd-6b7a2656d0f0" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/328171553.png"/>
    </span>
   </span>
  </p>
  <p style="margin-left: 660.0px;">
   <a href="#L12.1Dev:CustomerAging-Top">
    Back to Top
   </a>
  </p>
  <h3 id="L12.1Dev:CustomerAging-CreateReport">
   <span class="confluence-anchor-link" id="L12.1Dev:CustomerAging-CreateReport">
   </span>
  </h3>
  <h3 id="L12.1Dev:CustomerAging-CreateTheReport">
   Create The Report
  </h3>
  <p>
   <span>
    At this point you have a tested stored procedure that uses parameters to filter the results. An INTERJECT Data Connection is setup to go to your example database and you added an INTERJECT Data Portal to use that connection and is mapped to the stored procedure that was just created. Â You are ready to build the spreadsheet report.
   </span>
  </p>
  <p>
   <span>
    Fortunately, the documentation to build this report has already been presented in
   </span>
   <span>
    <strong>
     <a href="/wGetStarted/128429314.html" rel="nofollow">
      Create: Customer Aging
     </a>
    </strong>
   </span>
   <span>
    and you likely have already completed it. Â The end result should look like the below screenshot.
   </span>
  </p>
  <p>
   <span>
    <span class="confluence-embedded-file-wrapper">
     <img class="confluence-embedded-image confluence-content-image-border" data-base-url="https://interject.atlassian.net/wiki" data-image-src="attachments/324567045/327844019.png" data-linked-resource-container-id="324567045" data-linked-resource-container-version="32" data-linked-resource-content-type="image/png" data-linked-resource-default-alias="image2018-5-3_12-49-44.png" data-linked-resource-id="327844019" data-linked-resource-type="attachment" data-linked-resource-version="1" data-media-id="db16df0d-4e82-4fa9-b7bd-fa8df302b47e" data-media-type="file" data-unresolved-comment-count="0" src="attachments/324567045/327844019.png"/>
    </span>
   </span>
  </p>
  <p>
   <span>
    It is recommended to go to
    <strong>
     Create: Customer Aging
    </strong>
    to complete those steps again to reinforce the process. Â However, this time you can use your own Data Portal for the report.
   </span>
  </p>
  <p>
   <span>
    When going through the report creation steps, be sure to use your new Data Portal Code instead of the one used in the training. Please continue to the next lab after your new report is built.
   </span>
  </p>
  <p style="margin-left: 660.0px;">
   <span>
    <a href="#L12.1Dev:CustomerAging-Top">
     Back to Top
    </a>
   </span>
  </p>
 </div>
</div>